diff --git a/src/components/thiet-kegiandien/telesales-lien-he-khach-hang.vue b/src/components/thiet-kegiandien/telesales-lien-he-khach-hang.vue
index 47d1e024bf39354556167c1c82219a65ac0a2fd3..b123037263589e2d062ca6a34635d0a5b5e8160b 100644
--- a/src/components/thiet-kegiandien/telesales-lien-he-khach-hang.vue
+++ b/src/components/thiet-kegiandien/telesales-lien-he-khach-hang.vue
@@ -318,114 +318,158 @@
               :class="{ active: activeDetailTab === 'detail' }"
               @click="activeDetailTab = 'detail'"
           >
             <i class="fas fa-id-card"></i> Chi tiết
           </button>
           <button
               class="detail-tab"
               :class="{ active: activeDetailTab === 'history' }"
               @click="activeDetailTab = 'history'"
           >
             <i class="fas fa-history"></i> Lịch sử
           </button>
         </div>

         <div class="detail-content" v-if="selectedCustomer">
           <div v-if="activeDetailTab === 'detail'">
             <div class="customer-detail-header">
               <div
                   class="detail-avatar avatar-initials"
                   :style="selectedCustomer ? { backgroundColor: getAvatarColor(selectedCustomer.name) } : {}"
               >
                 {{ selectedCustomer ? getInitials(selectedCustomer.name) : '' }}
               </div>

               <div class="detail-name-info">
-                <h4>{{ selectedCustomer ? selectedCustomer.name : '' }}</h4>
-                <p class="detail-phone">{{ selectedCustomer ? selectedCustomer.phone : '' }}</p>
+                <input
+                    v-model="detailForm.name"
+                    class="detail-input detail-name-input"
+                    type="text"
+                    placeholder="Nhập họ tên khách"
+                />
+                <div class="detail-phone">{{ selectedCustomer ? selectedCustomer.phone : '' }}</div>
                 <p class="detail-received">
                   Tiếp nhận: {{ selectedCustomer ? formatReceivedAt(selectedCustomer.receivedAt) : '' }}
                 </p>
-                <p class="detail-type">
-                  <span :class="selectedCustomer ? `type-badge ${selectedCustomer.type}` : 'type-badge'">
-                    {{ selectedCustomer ? getCustomerTypeLabel(selectedCustomer.type) : '' }}
-                  </span>
-                </p>
               </div>
             </div>

             <div class="detail-section  mt-3">
               <h5><i class="fas fa-map-marked-alt"></i> Thông tin địa chỉ</h5>
               <div class="detail-row">
                 <span class="detail-label">Tỉnh hiện tại:</span>
-                <span class="detail-value">{{ selectedCustomer.province }}</span>
+                <div class="detail-select-wrapper">
+                  <input
+                      v-model="provinceSearch"
+                      type="text"
+                      class="detail-input search-enabled"
+                      placeholder="Chọn tỉnh/thành phố"
+                      @focus="provinceDropdownOpen = true"
+                      @input="provinceDropdownOpen = true"
+                      @blur="handleProvinceBlur"
+                  />
+                  <div v-if="provinceDropdownOpen" class="detail-dropdown">
+                    <button
+                        v-for="province in filteredProvinces"
+                        :key="province"
+                        type="button"
+                        class="detail-dropdown-item"
+                        @mousedown.prevent="selectProvince(province)"
+                    >
+                      {{ province }}
+                    </button>
+                    <div v-if="filteredProvinces.length === 0" class="detail-dropdown-empty">
+                      Không tìm thấy tỉnh phù hợp
+                    </div>
+                  </div>
+                </div>
               </div>
-              <div class="detail-row" v-if="selectedCustomer.oldProvince">
+              <div class="detail-row">
                 <span class="detail-label">Tỉnh cũ:</span>
-                <span class="detail-value">{{ selectedCustomer.oldProvince }}</span>
+                <input
+                    v-model="detailForm.oldProvince"
+                    type="text"
+                    class="detail-input"
+                    placeholder="Nhập tỉnh cũ"
+                />
               </div>
             </div>

             <div class="detail-section">
               <h5><i class="fas fa-coins"></i> Thông tin BĐS</h5>
               <div class="detail-row">
                 <span class="detail-label">Giá BĐS:</span>
-                <span class="detail-value">{{ formatCurrency(selectedCustomer.giaBDS) }}</span>
+                <input
+                    v-model="detailForm.giaBDS"
+                    type="text"
+                    inputmode="numeric"
+                    class="detail-input"
+                    placeholder="Nhập giá BĐS"
+                    @input="handleGiaBdsInput"
+                />
               </div>
             </div>

             <div class="detail-section">
               <h5><i class="fas fa-layer-group"></i> Phân loại khách</h5>
               <div class="detail-row">
                 <span class="detail-label">Loại khách:</span>
-                <span class="detail-value">{{ getCustomerTypeLabel(selectedCustomer.type) || 'Chưa phân loại' }}</span>
+                <select v-model="detailForm.type" class="detail-input detail-select-input">
+                  <option :value="null">Chưa phân loại</option>
+                  <option value="CHINH_CHU">Chủ nhà</option>
+                  <option value="MOI_GIOI">Môi giới</option>
+                  <option value="NGUOI_THAN">Người thân</option>
+                </select>
               </div>
             </div>

             <div class="detail-section">
               <h5><i class="fas fa-tags"></i> Đánh dấu khách hàng</h5>
               <div class="tag-selector">
                 <button
                     v-for="tag in availableTags"
                     :key="tag.value"
                     class="tag-option"
                     :class="{ active: isTagActive(tag.value) }"
                     :style="isTagActive(tag.value) ? { backgroundColor: tag.color, borderColor: tag.color, color: '#fff' } : {}"
                     @click="toggleCustomerStatus(tag.value)"
                 >
                   {{ tag.label }}
                 </button>
               </div>
             </div>

             <div class="detail-section mt-3">
               <h5>
                 <i class="fas fa-sticky-note"></i>Mô tả:
-                <span style="font-size: 14px; color: #4A4A4A; font-weight: 400">
-                  {{ selectedCustomer.note !== '' ? selectedCustomer.note : 'Không có' }}
-                </span>
               </h5>
+              <textarea
+                  v-model="detailForm.note"
+                  class="detail-textarea"
+                  rows="3"
+                  placeholder="Nhập mô tả cho khách hàng"
+              ></textarea>
             </div>

             <FileNew
                 v-if="selectedCustomer"
                 :key="'request-new-asset'"
                 :file-list="fileForm.files"
                 :entity-id="selectedCustomer.id"
                 :allow-download-all="true"
                 entity-type="host"
                 :can-edit="true"
                 :on-upload="true"
                 class="mt-2"
                 @update:files="handleFileUpdate"
             />

             <div class="add-note-form">
               <textarea v-model="newNote" placeholder="Thêm ghi chú cuộc gọi..." rows="3"></textarea>
             </div>

             <div class="detail-actions">
               <button class="action-btn move-btn" @click="moveToContacted">
                 <i class="fas fa-save"></i> Lưu thông tin
               </button>
             </div>
           </div>
@@ -460,83 +504,94 @@
                   </div>

                   <div class="history-note" v-if="item.ghiChu">
                     {{ item.ghiChu }}
                   </div>
                   <div class="history-note muted" v-else>
                     Không có mô tả
                   </div>
                 </div>
               </div>

               <div v-else class="empty-history">Chưa có lịch sử.</div>
             </div>
           </div>
         </div>
       </div>
     </div>
   </div>
 </template>

 <script setup>
 import { ref, computed, watch, onMounted, onUnmounted, nextTick } from 'vue'
 import Chart from 'chart.js/auto'
 import api from '/src/api/api.js'
 import FileNew from './File.vue'
+import addressData from '/src/assets/js/address.json'

 import NotificationBell from "../NotificationBell.vue";
 import { useAuthStore } from "/src/stores/authStore.js";
 import { useSidebarStore } from "/src/stores/sidebarStore.js";
 const authStore = useAuthStore();
 const info = authStore.userInfo;
 const sidebar = useSidebarStore();
 // ====== META ======
 const STATUS_META = {
   NEW: { label: 'Mới', color: '#94a3b8' },

   DC_TELESALES: { label: 'Mới tiếp nhận', color: '#6366f1' },
   CHAM_SOC: { label: 'Đang chăm sóc', color: '#38bdf8' },
   TN_7NGAY: { label: 'Tiềm năng 7 ngày', color: '#0ea5e9' },
   TN_14NGAY: { label: 'Tiềm năng 14 ngày', color: '#0284c7' },

   THAT_BAI: { label: 'Thất bại', color: '#f43f5e' },
   KHONG_LIEN_LAC_DUOC: { label: 'Không liên lạc được', color: '#f97316' },
   SAI_SO_LIEU: { label: 'Sai số liệu', color: '#a855f7' },

   THANH_CONG: { label: 'Thành công (Lên VP)', color: '#22c55e' },

   // ===== BỔ SUNG =====
   KHACH_HUY_HEN: { label: 'Khách huỷ hẹn', color: '#b45309' },   // cam nâu – huỷ
   BAN_NHANH: { label: 'Bán nhanh', color: '#15803d' },          // xanh lá đậm
   BAN_GP: { label: 'Bán GP (Đã lên VP)', color: '#0f766e' },    // xanh ngọc đậm
 }


 // ====== Reactive state ======
 const activeTab = ref('new')
 const activeDetailTab = ref('detail')
 const selectedCustomer = ref(null)
+const detailForm = ref({
+  name: '',
+  province: '',
+  oldProvince: '',
+  type: null,
+  giaBDS: '',
+  note: ''
+})
+const provinceSearch = ref('')
+const provinceDropdownOpen = ref(false)
 const newNote = ref('')
 const searchQuery = ref('')
 const originalFiles = ref([])
 const skipTabReload = ref(false)

 const fileForm = ref({
   files: [],
   newFiles: [],
   newLandBookFiles: [],
   deletedFileIds: [],
   deletedLandBookFileIds: []
 })

 // ✅ FIX all -> null
 const statusFilter = ref(null)
 const typeFilter = ref(null)

 const currentPage = ref(1)
 const pageSize = ref(10)

 const selectedTimeRange = ref('month')
 const selectedYear = ref(new Date().getFullYear())
 const selectedMonth = ref(new Date().getMonth() + 1)

 const lineChart = ref(null)
@@ -707,168 +762,242 @@ const getAvatarColor = (name) => {
 const formatTime = (isoString) => {
   if (!isoString) return 'Chưa gọi'
   const date = new Date(isoString)
   return date.toLocaleTimeString('vi-VN', { hour: '2-digit', minute: '2-digit' })
 }

 const formatReceivedAt = (isoString) => {
   if (!isoString) return '-'
   const date = new Date(isoString)
   return date.toLocaleString('vi-VN', {
     hour: '2-digit',
     minute: '2-digit',
     day: '2-digit',
     month: '2-digit',
     year: 'numeric'
   })
 }

 const formatCurrency = (value) => {
   if (value === null || value === undefined || value === '') return '-'
   const numericValue = Number(value)
   if (Number.isNaN(numericValue)) return value
   return `${new Intl.NumberFormat('vi-VN').format(numericValue)} ₫`
 }

+const normalizeText = (value) => (value || '').toString().toLowerCase().trim()
+
+const provinces = computed(() => (addressData || []).map((item) => item.name))
+
+const filteredProvinces = computed(() => {
+  const keyword = normalizeText(provinceSearch.value)
+  if (!keyword) return provinces.value
+  return provinces.value.filter((province) => normalizeText(province).includes(keyword))
+})
+
+const formatCurrencyInput = (value) => {
+  if (value === null || value === undefined) return ''
+  const digits = String(value).replace(/\D/g, '')
+  if (!digits) return ''
+  return digits.replace(/\B(?=(\d{3})+(?!\d))/g, '.')
+}
+
+const parseCurrencyInput = (value) => {
+  const digits = String(value || '').replace(/\D/g, '')
+  return digits ? Number(digits) : null
+}
+
+const handleGiaBdsInput = () => {
+  detailForm.value.giaBDS = formatCurrencyInput(detailForm.value.giaBDS)
+}
+
+const selectProvince = (province) => {
+  detailForm.value.province = province
+  provinceSearch.value = province
+  provinceDropdownOpen.value = false
+}
+
+const handleProvinceBlur = () => {
+  setTimeout(() => {
+    detailForm.value.province = provinceSearch.value
+    provinceDropdownOpen.value = false
+  }, 150)
+}
+
+const handleDocumentClick = (event) => {
+  if (!event.target.closest('.detail-select-wrapper')) {
+    provinceDropdownOpen.value = false
+    detailForm.value.province = provinceSearch.value
+  }
+}
+
+const syncDetailForm = (customer) => {
+  detailForm.value = {
+    name: customer?.name || '',
+    province: customer?.province || '',
+    oldProvince: customer?.oldProvince || '',
+    type: customer?.type ?? null,
+    giaBDS: formatCurrencyInput(customer?.giaBDS ?? ''),
+    note: customer?.note || ''
+  }
+  provinceSearch.value = detailForm.value.province
+}
+
 // ====== Detail actions ======
 const selectCustomer = (customer) => {
   selectedCustomer.value = customer
   activeDetailTab.value = 'detail'
   newNote.value = ''
+  syncDetailForm(customer)
   resetFileForm(customer?.files)
 }

 const toggleCustomerStatus = (status) => {
   if (!selectedCustomer.value) return
   selectedCustomer.value.status = selectedCustomer.value.status === status ? null : status
 }

 const resetFileForm = (files) => {
   const safeFiles = Array.isArray(files) ? JSON.parse(JSON.stringify(files)) : []
   fileForm.value = {
     files: safeFiles,
     newFiles: [],
     newLandBookFiles: [],
     deletedFileIds: [],
     deletedLandBookFileIds: []
   }
   originalFiles.value = JSON.parse(JSON.stringify(safeFiles))
 }

 const handleFileUpdate = (files) => {
   fileForm.value.files = Array.isArray(files) ? files : []

   const existingFiles = fileForm.value.files.filter((file) => !file.file && file.id)
   const newFiles = fileForm.value.files.filter((file) => file.file instanceof File)

   fileForm.value.newFiles = newFiles
       .filter((file) => !file.isIG)
       .map((file) => ({ file: file.file, isOnTop: file.isOnTop }))

   fileForm.value.newLandBookFiles = newFiles
       .filter((file) => file.isIG)
       .map((file) => ({ file: file.file, isOnTop: file.isOnTop }))

   const originalIds = (originalFiles.value || []).map((file) => file.id)
   const currentIds = existingFiles.map((file) => file.id)

   fileForm.value.deletedFileIds = originalIds.filter((id) => {
     const file = (originalFiles.value || []).find((item) => item.id === id)
     return !currentIds.includes(id) && file && !file.isIG
   })

   fileForm.value.deletedLandBookFileIds = originalIds.filter((id) => {
     const file = (originalFiles.value || []).find((item) => item.id === id)
     return !currentIds.includes(id) && file && file.isIG
   })
 }

 const buildFilePayload = () => {
+  const giaBDSValue = parseCurrencyInput(detailForm.value.giaBDS)
   const dto = {
     customerId: selectedCustomer.value.id,
     status: selectedCustomer.value.status,
     description: newNote.value,
+    hoTen: detailForm.value.name,
+    soDienThoai: selectedCustomer.value.phone,
+    tinhMoi: detailForm.value.province,
+    tinhCu: detailForm.value.oldProvince || null,
+    type: detailForm.value.type || null,
+    giaBDS: giaBDSValue,
+    ghiChu: detailForm.value.note || '',
     files: fileForm.value.files
         .filter((file) => !file.file && file.id)
         .map((file) => ({
           id: file.id,
           fileName: file.fileName,
           isIG: file.isIG,
           isOnTop: file.isOnTop
         })),
     deletedFileIds: fileForm.value.deletedFileIds,
     deletedLandBookFileIds: fileForm.value.deletedLandBookFileIds
   }

   const fd = new FormData()
   fd.append('dto', new Blob([JSON.stringify(dto)], { type: 'application/json' }))

   const mainFile = fileForm.value.newFiles.find((file) => file?.isOnTop && file.file instanceof File)
       || fileForm.value.newLandBookFiles.find((file) => file?.isOnTop && file.file instanceof File)

   if (mainFile) {
     fd.append('newFileOntop', mainFile.file)
   }

   fileForm.value.newFiles.forEach((file) => {
     if (file?.file instanceof File) {
       fd.append('newFiles', file.file)
     }
   })

   fileForm.value.newLandBookFiles.forEach((file) => {
     if (file?.file instanceof File) {
       fd.append('newLandBookFiles', file.file)
     }
   })

   return fd
 }

 const moveToContacted = async () => {
   if (!selectedCustomer.value) return

   try {
+    selectedCustomer.value.name = detailForm.value.name
+    selectedCustomer.value.province = detailForm.value.province
+    selectedCustomer.value.oldProvince = detailForm.value.oldProvince || null
+    selectedCustomer.value.type = detailForm.value.type || null
+    selectedCustomer.value.giaBDS = parseCurrencyInput(detailForm.value.giaBDS)
+    selectedCustomer.value.note = detailForm.value.note || ''
     const targetId = selectedCustomer.value.id
     const payload = buildFilePayload()
     const flag = selectedCustomer.value.status === 'THANH_CONG'
     await api.post('/customer-crm/telesales/journey-history/create', payload, {
       headers: { 'Content-Type': 'multipart/form-data' }
     })

     skipTabReload.value = activeTab.value !== 'contacted'
     activeTab.value = 'contacted'
     await Promise.all([loadKhachDaLienHe(), loadKhachMoiTiepNhan()])

     const updatedCustomer = contactedCustomers.value.find((c) => c.id === targetId)
         || newCustomers.value.find((c) => c.id === targetId)

     selectedCustomer.value = updatedCustomer || null
     activeDetailTab.value = 'detail'
     newNote.value = ''
     if (selectedCustomer.value) {
       resetFileForm(selectedCustomer.value.files)
+      syncDetailForm(selectedCustomer.value)
     } else {
       resetFileForm([])
     }

     // ===== LƯU LOCAL STORAGE + CHUYỂN TRANG =====
     if (flag) {
       localStorage.setItem('flagDatLich', 'true')
       localStorage.setItem('customerPhone', selectedCustomer.value.phone)

       // chuyển qua trang đặt lịch
       window.location.href = '/-thg/quan-ly-lich-hen'
     }


     // reload thống kê
     await refreshData()
   } catch (err) {
     console.error(err)
   }
 }

 // ====== API ======
 const fetchThongKeHomNay = async () => {
   try {
     const { data } = await api.get('/customer-crm/telesales/thong-ke/hom-nay')
@@ -1140,62 +1269,64 @@ const initSummaryChart = () => {
           position: 'bottom',
           labels: { boxWidth: 12, font: { size: 12 } }
         }
       }
     },
     plugins: [doughnutTotalPlugin]
   })

 }

 // ====== Refresh all ======
 const refreshData = async () => {
   await Promise.all([
     loadKhachMoiTiepNhan,
     loadKhachDaLienHe(),
     fetchThongKeHomNay(),
     fetchThongKeTrangThaiTeleSales(),
     fetchThongKeBieuDo()
   ])
   await nextTick()
   initSummaryChart()
 }

 // ====== Lifecycle ======
 onMounted(async () => {
+  document.addEventListener('click', handleDocumentClick)
   await Promise.all([
     fetchThongKeHomNay(),
     loadKhachDaLienHe(),
     fetchThongKeTrangThaiTeleSales(),
     loadKhachMoiTiepNhan(),
     fetchThongKeBieuDo()
   ])
   await nextTick()
   initSummaryChart()
 })

 onUnmounted(() => {
+  document.removeEventListener('click', handleDocumentClick)
   if (lineChartInstance.value) lineChartInstance.value.destroy()
   if (summaryChartInstance.value) summaryChartInstance.value.destroy()
 })
 </script>

 <style scoped>
 /* Reset và kiểu cơ bản */
 * {
   margin: 0;
   padding: 0;
   box-sizing: border-box;
 }

 body {
   font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
   background-color: #f0f2f5;
   color: #333;

 }

 .telesale-app {
   position: relative;
   top: -10px!important;
   display: flex;
   flex-direction: column;
@@ -1995,62 +2126,157 @@ body {
 .type-badge.MOI_GIOI {
   background-color: #1e88e5;
 }

 .type-badge.CHINH_CHU {
   background-color: #2e7d32;
 }

 .type-badge.NGUOI_THAN {
   background-color: #6a1b9a;
 }

 .detail-section h5 {
   font-size: 16px;
   margin-bottom: 12px;
   color: #3f51b5;
   display: flex;
   align-items: center;
   gap: 8px;
 }

 .detail-row {
   display: flex;
   justify-content: space-between;
   margin-bottom: 10px;
+  align-items: center;
+  gap: 12px;
 }

 .detail-label {
   color: #666;
   font-size: 14px;
+  min-width: 110px;
 }

 .detail-value {
   font-weight: 500;
   font-size: 14px;
 }

+.detail-input {
+  flex: 1;
+  padding: 8px 12px;
+  border: 1px solid #e2e8f0;
+  border-radius: 8px;
+  font-size: 14px;
+  color: #1e293b;
+  background: #ffffff;
+  transition: border-color 0.2s ease, box-shadow 0.2s ease;
+}
+
+.detail-input:focus {
+  outline: none;
+  border-color: #6366f1;
+  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
+}
+
+.detail-name-input {
+  font-size: 18px;
+  font-weight: 600;
+  padding: 6px 10px;
+  margin-bottom: 6px;
+}
+
+.detail-select-input {
+  appearance: none;
+  background-image: linear-gradient(45deg, transparent 50%, #94a3b8 50%),
+    linear-gradient(135deg, #94a3b8 50%, transparent 50%);
+  background-position: calc(100% - 18px) calc(50% - 2px), calc(100% - 12px) calc(50% - 2px);
+  background-size: 6px 6px, 6px 6px;
+  background-repeat: no-repeat;
+}
+
+.detail-select-wrapper {
+  position: relative;
+  flex: 1;
+}
+
+.detail-dropdown {
+  position: absolute;
+  top: calc(100% + 6px);
+  left: 0;
+  right: 0;
+  background: #ffffff;
+  border: 1px solid #e2e8f0;
+  border-radius: 10px;
+  max-height: 220px;
+  overflow-y: auto;
+  z-index: 10;
+  box-shadow: 0 10px 20px rgba(15, 23, 42, 0.12);
+  padding: 6px;
+}
+
+.detail-dropdown-item {
+  width: 100%;
+  text-align: left;
+  padding: 8px 10px;
+  border: none;
+  background: transparent;
+  border-radius: 8px;
+  font-size: 14px;
+  color: #1e293b;
+  cursor: pointer;
+}
+
+.detail-dropdown-item:hover {
+  background: #eef2ff;
+}
+
+.detail-dropdown-empty {
+  padding: 8px 10px;
+  font-size: 13px;
+  color: #94a3b8;
+}
+
+.detail-textarea {
+  width: 100%;
+  padding: 10px 12px;
+  border: 1px solid #e2e8f0;
+  border-radius: 10px;
+  font-size: 14px;
+  color: #1e293b;
+  background: #ffffff;
+  resize: vertical;
+}
+
+.detail-textarea:focus {
+  outline: none;
+  border-color: #6366f1;
+  box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
+}
+
 .tag-selector {
   display: flex;
   flex-wrap: wrap;
   gap: 8px;
 }

 .tag-option {
   padding: 6px 12px;
   border-radius: 999px;
   border: 1px solid #e5e7eb;
   background: #fff;
   font-size: 13px;
   transition: all 0.2s ease;
 }

 .tag-option.active {
   font-weight: 500;
 }


 .tag-option:hover {
   background-color: #f5f5f5;
 }

 .tag-option:not(.active):hover {
