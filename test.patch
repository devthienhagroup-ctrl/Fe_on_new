diff --git a/src/components/thiet-kegiandien/admin-saleadmin.vue b/src/components/thiet-kegiandien/admin-saleadmin.vue
index 88846860a7c4f4f5e0f42f396561b41025ac760b..054f775adf1bc6d388cbce438b954e38568cfd16 100644
--- a/src/components/thiet-kegiandien/admin-saleadmin.vue
+++ b/src/components/thiet-kegiandien/admin-saleadmin.vue
@@ -1033,81 +1033,94 @@
           </div>
         </div>
       </div>

     <!-- Assign Data Modal -->
     <div v-if="showAssignDataModal" class="modal fade modal-custom assign-data-modal show" tabindex="-1">
       <div class="modal-dialog modal-lg">
         <div class="modal-content">
           <div class="modal-header">
             <h5 class="modal-title"><i class="fas fa-user-tag me-2"></i> Cấp dữ liệu cho Telesale</h5>
             <button type="button" class="btn-close btn-close-white" @click="closeAssignDataModal"></button>
           </div>
           <div class="modal-body">
             <div class="mb-4">
               <h6 class="fw-medium mb-3">Chọn nhân viên Telesale</h6>
               <div class="staff-grid">
                 <div
                     v-for="staff in staffMembers"
                     :key="staff.id"
                     class="staff-card"
                     :class="{ selected: staff.selected }"
                     @click="toggleStaffSelection(staff)"
                 >
                   <img :src="staff.avatar" :alt="staff.name" class="staff-avatar">
                   <div class="staff-name">{{ staff.name }}</div>
-                  <div class="staff-role">{{ staff.role }}</div>
+                  <div class="staff-meta">
+                    <span v-if="staff.email">{{ staff.email }}</span>
+                    <span v-if="staff.phone">{{ staff.phone }}</span>
+                  </div>
                 </div>
               </div>
             </div>

             <div class="row">
               <div class="col-md-6 mb-3">
                 <label for="dataQuantity" class="form-label fw-medium">Số lượng dữ liệu cấp</label>
-                <input type="number" class="form-control form-control-custom" v-model="assignData.quantity" min="1" max="1000">
-                <small class="text-muted">Số khách hàng sẽ được cấp (1-1000)</small>
+                <div class="form-control form-control-custom assign-quantity">
+                  {{ assignQuantity }}
+                </div>
+                <small class="text-muted">Số khách hàng sẽ được cấp theo số hàng đã chọn</small>
               </div>
               <div class="col-md-6 mb-3">
                 <label for="dataType" class="form-label fw-medium">Kiểm tra dữ liệu</label>
-                <select class="form-select form-select-custom" v-model="assignData.type">
-                  <option value="new">Khách hàng mới</option>
-                  <option value="potential">Khách tiềm năng</option>
-                  <option value="all">Tất cả loại khách</option>
-                  <option value="by_province">Theo tỉnh thành</option>
-                </select>
+                <div class="assign-check">
+                  <span class="assign-check-icon" :class="isAllSelectedNew ? 'is-yes' : 'is-no'">
+                    <i :class="isAllSelectedNew ? 'fas fa-check-circle' : 'fas fa-times-circle'"></i>
+                  </span>
+                  <span class="assign-check-text">{{ isAllSelectedNew ? 'Yes' : 'No' }}</span>
+                </div>
+                <small class="text-muted">
+                  Tất cả khách hàng đã chọn phải ở trạng thái NEW
+                </small>
               </div>
             </div>


             <div class="alert alert-info">
               <i class="fas fa-info-circle me-2"></i>
               <span>{{ assignSummary }}</span>
             </div>
           </div>
           <div class="modal-footer">
             <button type="button" class="btn btn-outline-custom btn-custom" @click="closeAssignDataModal">Hủy</button>
-            <button type="button" class="btn btn-primary-custom btn-custom" @click="confirmAssignData">
+            <button
+                type="button"
+                class="btn btn-primary-custom btn-custom"
+                :disabled="!canAssignData"
+                @click="confirmAssignData"
+            >
               <i class="fas fa-check me-2"></i> Xác nhận cấp dữ liệu
             </button>
           </div>
         </div>
       </div>
     </div>

     <!-- Confirm Delete Modal -->
     <div v-if="showConfirmDeleteModal" class="modal fade modal-custom show" tabindex="-1">
       <div class="modal-dialog">
         <div class="modal-content">
           <div class="modal-header">
             <h5 class="modal-title"><i class="fas fa-exclamation-triangle me-2"></i> Xác nhận xóa</h5>
             <button type="button" class="btn-close btn-close-white" @click="closeConfirmDeleteModal"></button>
           </div>
           <div class="modal-body">
             <div class="text-center mb-4">
               <div class="mb-3">
                 <i class="fas fa-trash-alt fa-3x text-danger"></i>
               </div>
               <h4 class="fw-bold">Bạn có chắc chắn muốn xóa khách hàng "{{ deletingCustomer?.name }}" ?</h4>
               <p class="text-muted">Hành động này không thể hoàn tác. Tất cả dữ liệu liên quan sẽ bị xóa vĩnh viễn.</p>
             </div>
           </div>
           <div class="modal-footer justify-content-center">
@@ -1121,60 +1134,51 @@
     </div>

     <!-- Notifications -->
     <div v-if="notification.show" class="notification" :class="notification.type">
       <div class="d-flex align-items-start">
         <i :class="`fas fa-${notification.icon} me-2 mt-1`"></i>
         <span>{{ notification.message }}</span>
       </div>
     </div>
     </div>
   </div>
 </template>

 <script setup>
 import { ref, computed, reactive, onMounted, nextTick, watch } from 'vue'
 import Chart from 'chart.js/auto'
 import addressData from '/src/assets/js/address.json'
 import FileNew from './File.vue'

 // State management
 const customers = ref([])
 const totalElements = ref(0)
 const totalPages = ref(0)
 const loading = ref(false)

-const staffMembers = ref([
-  { id: 1, name: "Nguyễn Văn A", role: "Telesale Manager", avatar: "https://randomuser.me/api/portraits/men/1.jpg", selected: false },
-  { id: 2, name: "Trần Thị B", role: "Senior Telesale", avatar: "https://randomuser.me/api/portraits/women/2.jpg", selected: false },
-  { id: 3, name: "Lê Văn C", role: "Telesale Executive", avatar: "https://randomuser.me/api/portraits/men/3.jpg", selected: false },
-  { id: 4, name: "Phạm Thị D", role: "Junior Telesale", avatar: "https://randomuser.me/api/portraits/women/4.jpg", selected: false },
-  { id: 5, name: "Hoàng Văn E", role: "Telesale Team Lead", avatar: "https://randomuser.me/api/portraits/men/5.jpg", selected: false },
-  { id: 6, name: "Vũ Thị F", role: "Telesale Specialist", avatar: "https://randomuser.me/api/portraits/women/6.jpg", selected: false },
-  { id: 7, name: "Đặng Văn G", role: "Senior Telesale", avatar: "https://randomuser.me/api/portraits/men/7.jpg", selected: false },
-  { id: 8, name: "Bùi Thị H", role: "Telesale Executive", avatar: "https://randomuser.me/api/portraits/women/8.jpg", selected: false }
-])
+const staffMembers = ref([])

 const creatorOptions = ref([
   { id: 1, name: "Trần Minh Anh", avatar: "https://randomuser.me/api/portraits/women/11.jpg" },
   { id: 2, name: "Phạm Quốc Huy", avatar: "https://randomuser.me/api/portraits/men/12.jpg" },
   { id: 3, name: "Nguyễn Thảo My", avatar: "https://randomuser.me/api/portraits/women/13.jpg" },
   { id: 4, name: "Lê Hoàng Nam", avatar: "https://randomuser.me/api/portraits/men/14.jpg" }
 ])

 // UI state
 const mobileMenuOpen = ref(false)
 const notificationsOpen = ref(false)
 const userMenuOpen = ref(false)
 const activeTab = ref('all')
 const chartYear = ref('2024')
 const searchText = ref('')

 // Modal states
 const showAddCustomerModal = ref(false)
 const showAssignDataModal = ref(false)
 const showCallModal = ref(false)
 const showConfirmDeleteModal = ref(false)
 const showEditCustomerModal = ref(false)
 const showDetailModal = ref(false)
 const isAnyModalOpen = computed(() =>
   showAddCustomerModal.value ||
@@ -1186,116 +1190,122 @@ const isAnyModalOpen = computed(() =>

 // Data state
 const filters = reactive({
   type: 'all',
   status: 'all',
   province: '',
   creator: 'all',
   createdFrom: '',
   createdTo: '',
   updatedFrom: '',
   updatedTo: ''
 })

 const customerForm = reactive({
   id: null,
   name: '',
   phone: '',
   province: '',
   oldProvince: '',
   type: '',
   status: 'new',
   avatar: '',
   notes: ''
 })

-const assignData = reactive({
-  quantity: 50,
-  type: 'new',
-  notes: ''
-})

 const callingCustomer = ref(null)
 const deletingCustomer = ref(null)
 const callSeconds = ref(0)
 const callNotes = ref('')
 const isEditing = ref(false)
 const selectedCustomer = ref(null)
 const fileForm = reactive({
   files: []
 })

 const notification = reactive({
   show: false,
   message: '',
   type: 'info',
   icon: 'info-circle'
 })

 // Refs
 const monthlyChart = ref(null)
 const statusChart = ref(null)

 // Computed properties
 const filterTabs = computed(() => [
   { value: 'all', label: 'Tất cả' },
   { value: 'new', label: 'Mới' },
   { value: 'contacted', label: 'Đã dùng' }
 ])


 const selectedCount = computed(() => {
   return customers.value.filter(c => c.selected).length
 })

+const selectedCustomerIds = computed(() => {
+  return customers.value.filter(c => c.selected).map(c => c.id)
+})
+
 const isAllSelected = computed(() => {
   return selectedCount.value === customers.value.length && customers.value.length > 0
 })

+const isAllSelectedNew = computed(() => {
+  if (selectedCount.value === 0) return false
+  return customers.value
+      .filter(c => c.selected)
+      .every(c => c.trangThai === 'NEW')
+})
+
+const assignQuantity = computed(() => selectedCount.value)
+
+const selectedTeleSales = computed(() => {
+  return staffMembers.value.find(staff => staff.selected) || null
+})
+
+const canAssignData = computed(() => {
+  return selectedCount.value > 0 && isAllSelectedNew.value && !!selectedTeleSales.value
+})
+
 const callTimer = computed(() => {
   const minutes = Math.floor(callSeconds.value / 60).toString().padStart(2, '0')
   const seconds = (callSeconds.value % 60).toString().padStart(2, '0')
   return `${minutes}:${seconds}`
 })

 const detailCustomer = computed(() => selectedCustomer.value?.customerListItemDTO || null)
 const detailHistory = computed(() => selectedCustomer.value?.lichSu || [])

 const assignSummary = computed(() => {
-  const selectedStaff = staffMembers.value.filter(s => s.selected)
-  if (selectedStaff.length === 0) return 'Chưa có nhân viên nào được chọn'
-
-  let typeText = ''
-  switch (assignData.type) {
-    case 'new': typeText = 'khách hàng mới'; break
-    case 'potential': typeText = 'khách tiềm năng'; break
-    case 'all': typeText = 'tất cả loại khách'; break
-    case 'by_province': typeText = 'theo tỉnh thành'; break
-  }
-
-  const staffNames = selectedStaff.map(s => s.name).join(', ')
-  return `Sẽ cấp ${assignData.quantity} ${typeText} cho ${selectedStaff.length} nhân viên: ${staffNames}`
+  if (selectedCount.value === 0) return 'Chưa có khách hàng nào được chọn'
+  if (!selectedTeleSales.value) return 'Chưa chọn nhân viên Telesale'
+  return `Sẽ cấp ${assignQuantity.value} khách hàng cho ${selectedTeleSales.value.name}`
 })

 const provinceOptions = computed(() => {
   const provinceNames = addressData.map(province => province.name)
   return [...provinceNames, 'Khác']
 })

 const creatorsById = computed(() => {
   return creatorOptions.value.reduce((acc, creator) => {
     acc[creator.id] = creator
     return acc
   }, {})
 })

 const staffById = computed(() => {
   return staffMembers.value.reduce((acc, staff) => {
     acc[staff.id] = staff
     return acc
   }, {})
 })

 // Methods
 const toggleMobileMenu = () => {
   mobileMenuOpen.value = !mobileMenuOpen.value
 }
@@ -1531,83 +1541,86 @@ const toggleSelectAll = (event) => {
 }

 const clearSelection = () => {
   customers.value.forEach(c => c.selected = false)
 }

 const bulkDelete = () => {
   const selectedCustomers = customers.value.filter(c => c.selected)
   if (selectedCustomers.length > 0) {
     if (confirm(`Bạn có chắc chắn muốn xóa ${selectedCustomers.length} khách hàng đã chọn?`)) {
       customers.value = customers.value.filter(c => !c.selected)
       showNotification(`Đã xóa ${selectedCustomers.length} khách hàng thành công!`, 'success')
     }
   }
 }

 const openAssignDataModal = () => {
   showAssignDataModal.value = true
 }

 const closeAssignDataModal = () => {
   showAssignDataModal.value = false
 }

 const toggleStaffSelection = (staff) => {
-  staff.selected = !staff.selected
+  const shouldSelect = !staff.selected
+  staffMembers.value.forEach(member => {
+    member.selected = false
+  })
+  staff.selected = shouldSelect
 }

-const confirmAssignData = () => {
-  const selectedStaff = staffMembers.value.filter(s => s.selected)
-  if (selectedStaff.length === 0) {
-    showNotification('Vui lòng chọn ít nhất một nhân viên!', 'warning')
+const confirmAssignData = async () => {
+  if (selectedCount.value === 0) {
+    showNotification('Vui lòng chọn khách hàng trước khi cấp dữ liệu!', 'warning')
     return
   }
-  if (assignData.quantity < 1 || assignData.quantity > 1000) {
-    showNotification('Số lượng dữ liệu phải từ 1 đến 1000!', 'warning')
+  if (!isAllSelectedNew.value) {
+    showNotification('Chỉ có thể cấp dữ liệu cho khách hàng ở trạng thái NEW!', 'warning')
+    return
+  }
+  if (!selectedTeleSales.value) {
+    showNotification('Vui lòng chọn 1 nhân viên Telesale!', 'warning')
     return
   }

-  const dataPerStaff = Math.floor(assignData.quantity / selectedStaff.length)
-  const remainder = assignData.quantity % selectedStaff.length
-
-  let resultMessage = `Đã cấp ${assignData.quantity} dữ liệu ${assignData.type} cho ${selectedStaff.length} nhân viên:\n`
-  selectedStaff.forEach((staff, index) => {
-    let staffQuantity = dataPerStaff
-    if (index < remainder) staffQuantity++
-    resultMessage += `- ${staff.name}: ${staffQuantity} khách\n`
-  })
-  if (assignData.notes) resultMessage += `\nGhi chú: ${assignData.notes}`
-
-  showNotification(resultMessage, 'success')
-
-  // Reset staff selection
-  staffMembers.value.forEach(s => s.selected = false)
-  assignData.quantity = 50
-  assignData.type = 'new'
-  assignData.notes = ''
-  showAssignDataModal.value = false
+  try {
+    await api.post('/cap-data', {
+      nhanVienId: selectedTeleSales.value.id,
+      khachHangIds: selectedCustomerIds.value
+    })
+    showNotification(`Đã cấp ${assignQuantity.value} khách hàng cho ${selectedTeleSales.value.name}`, 'success')
+    clearSelection()
+    staffMembers.value.forEach(member => {
+      member.selected = false
+    })
+    showAssignDataModal.value = false
+  } catch (e) {
+    console.error(e)
+    showNotification('Cấp dữ liệu thất bại, vui lòng thử lại!', 'warning')
+  }
 }

 const exportExcel = () => {
   showNotification('Xuất dữ liệu ra Excel thành công!', 'success')
 }

 const exportPDF = () => {
   showNotification('Xuất dữ liệu ra PDF thành công!', 'success')
 }

 const showNotification = (message, type = 'info') => {
   notification.message = message
   notification.type = type
   notification.icon = type === 'success' ? 'check-circle' :
       type === 'warning' ? 'exclamation-triangle' : 'info-circle'
   notification.show = true

   setTimeout(() => {
     notification.show = false
   }, 5000)
 }

 // Helper functions
 const toDate = (value) => {
   if (!value) return new Date(0)
@@ -1759,51 +1772,65 @@ const initCharts = () => {
                 const total = context.dataset.data.reduce((a, b) => a + b, 0)
                 const percentage = Math.round((value / total) * 100)
                 return `${label}: ${value} (${percentage}%)`
               }
             }
           }
         },
         cutout: '75%'
       }
     })
   }
 }

 const fetchMarketing = async () => {
   try {
     const res = await api.get('/customer-crm/admin/marketing')
     marketingoptions.value = res.data
   } catch (e) {
     console.error(e)
   }
 }

 const fetchTeleSales = async () => {
   try {
     const res = await api.get('/customer-crm/admin/telesales')
-    console.log(res.data)
+    staffMembers.value = res.data.map((staff) => {
+      const avatarPath = staff.avatar
+        ? (staff.avatar.startsWith('http')
+          ? staff.avatar
+          : `https://s3.cloudfly.vn/thg-storage-dev/uploads-public/${staff.avatar}`)
+        : generateAvatarFromName(staff.tenNhanVien)
+      return {
+        id: staff.id,
+        name: staff.tenNhanVien,
+        avatar: avatarPath,
+        email: staff.email || '',
+        phone: staff.phone || '',
+        selected: false
+      }
+    })
   } catch (e) {
     console.error(e)
   }
 }

 onMounted(async () => {
   await fetchMarketing()
   await fetchTeleSales()
   await fetchCustomers()
   initCharts()
 })


 watch(activeTab, (tab) => {
   if (tab !== 'contacted') {
     filters.status = 'all'
   }
 })
 watch(searchText, () => {
   page.value = 0
   fetchCustomers()
 })
 watch(
     () => ({ ...filters }),
     () => {
@@ -2821,51 +2848,84 @@ h1,h2,h3,h4,h5,h6 { font-family: 'Poppins', sans-serif; font-weight: 600; }
   text-align: center;
   border: 2px solid transparent;
   transition: all var(--transition-normal);
   cursor: pointer;
   box-shadow: var(--shadow-soft);
 }
 .assign-data-modal .staff-card:hover {
   transform: translateY(-5px);
   border-color: var(--primary-color);
   box-shadow: var(--shadow-medium);
 }
 .assign-data-modal .staff-card.selected {
   background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
   border-color: var(--primary-color);
 }
 .assign-data-modal .staff-avatar {
   width: 60px;
   height: 60px;
   border-radius: 50%;
   object-fit: cover;
   margin-bottom: 10px;
   border: 3px solid #fff;
   box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
 }
 .assign-data-modal .staff-name { font-weight: 600; margin-bottom: 5px; }
-.assign-data-modal .staff-role { font-size: 12px; color: #6c757d; }
+.assign-data-modal .staff-meta {
+  font-size: 12px;
+  color: #6c757d;
+  display: flex;
+  flex-direction: column;
+  gap: 2px;
+}
+.assign-data-modal .assign-quantity {
+  display: flex;
+  align-items: center;
+  min-height: 44px;
+  font-weight: 600;
+}
+.assign-data-modal .assign-check {
+  display: flex;
+  align-items: center;
+  gap: 10px;
+  min-height: 44px;
+}
+.assign-data-modal .assign-check-icon {
+  font-size: 22px;
+  display: inline-flex;
+  align-items: center;
+  justify-content: center;
+}
+.assign-data-modal .assign-check-icon.is-yes {
+  color: #16a34a;
+}
+.assign-data-modal .assign-check-icon.is-no {
+  color: #dc2626;
+}
+.assign-data-modal .assign-check-text {
+  font-weight: 600;
+}

 /* Call Modal */
 .call-avatar {
   width: 100px; height: 100px;
   border-radius: 50%;
   object-fit: cover;
   border: 5px solid white;
   box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
   margin-bottom: 20px;
 }
 .call-timer {
   font-size: 3.5rem;
   font-weight: 700;
   background: var(--primary-gradient);
   -webkit-background-clip: text;
   -webkit-text-fill-color: transparent;
   background-clip: text;
   margin: 20px 0;
   text-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
 }

 /* Glow + gradient text */
 .glow { box-shadow: 0 0 20px rgba(102, 126, 234, 0.5); }
 .gradient-text {
   background: var(--primary-gradient);
