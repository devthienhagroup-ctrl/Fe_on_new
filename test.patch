diff --git a/src/components/dich-vu/Phi-dich-vu.vue b/src/components/dich-vu/Phi-dich-vu.vue
index 85729a1952a67386edeecaf3505db0bb8bf003ab..02426bab01740375b248de996f38d62b1a83bbb0 100644
--- a/src/components/dich-vu/Phi-dich-vu.vue
+++ b/src/components/dich-vu/Phi-dich-vu.vue
@@ -401,50 +401,140 @@
                       <div class="customer-name">{{ customerSearchError }}</div>
                       <div class="customer-phone">Thử nhập tên khác.</div>
                     </div>
                   </div>
                 </div>

                 <div v-if="selectedCustomer" class="selected-customer">
                   <div class="customer-avatar">{{ initials(selectedCustomer.name) }}</div>
                   <div class="min-w-0">
                     <div class="customer-name">{{ selectedCustomer.name }}</div>
                     <div class="customer-phone"><i class="fa-solid fa-phone me-1"></i>{{ selectedCustomer.phone }}</div>
                   </div>
                   <button class="clear-btn" type="button" @click="clearSelectedCustomer">
                     <i class="fa-solid fa-xmark"></i>
                   </button>
                 </div>
               </div>
                 <div class="field !m-0" style="max-height: 50px !important;">
                   <label class="field-label">
                     <span class="label-ico tone-emerald"><i class="fa-solid fa-phone"></i></span>
                     <span>Số điện thoại</span>
                   </label>
                   <input :value="selectedCustomer?.phone || ''" type="text" readonly>
                 </div>
               </div>
+              <div class="section-title">
+                <i class="fa-solid fa-user-check"></i>
+                Nhân viên chốt
+              </div>
+
+              <div class="grid grid-cols-1 md:grid-cols-2 gap-3 px-3 pb-2">
+                <div class="field !m-0">
+                  <label class="field-label">
+                    <span class="label-ico tone-sky"><i class="fa-solid fa-user-check"></i></span>
+                    <span>Hình thức chốt</span>
+                  </label>
+                  <select v-model="nguoiChotMode">
+                    <option value="SELF">Chính mình chốt</option>
+                    <option value="OTHER">Người khác chốt</option>
+                  </select>
+                  <div class="muted tiny">Chọn người chốt hợp đồng.</div>
+                </div>
+
+                <div class="field !m-0">
+                  <label class="field-label">
+                    <span class="label-ico tone-indigo"><i class="fa-solid fa-user"></i></span>
+                    <span>Nhân viên chốt</span>
+                  </label>
+                  <input
+                    :value="nguoiChotDisplayName"
+                    type="text"
+                    readonly
+                    placeholder="Chưa chọn nhân viên"
+                  >
+                  <div class="muted tiny">
+                    {{ nguoiChotMode === 'SELF' ? 'Tự động lấy từ tài khoản hiện tại.' : 'Chọn từ danh sách tìm kiếm.' }}
+                  </div>
+                </div>
+              </div>
+
+              <div v-if="nguoiChotMode === 'OTHER'" class="employee-search customer-search px-3 pb-2">
+                <div class="field !m-0">
+                  <label class="field-label">
+                    <span class="label-ico tone-lilac"><i class="fa-solid fa-magnifying-glass"></i></span>
+                    <span>Tìm nhân viên</span>
+                  </label>
+                  <input v-model="employeeSearch" type="text" placeholder="Nhập tên, email hoặc SĐT...">
+
+                  <div class="search-results" v-if="employeeSearchResults.length">
+                    <div v-for="employee in employeeSearchResults" :key="employee.id" class="customer-result" @click="selectEmployee(employee)">
+                      <img
+                        v-if="employee.avatar"
+                        :src="getEmployeeAvatarUrl(employee.avatar)"
+                        alt="avatar"
+                        class="customer-avatar sm"
+                      />
+                      <div v-else class="customer-avatar sm">{{ initials(employee.tenNhanVien) }}</div>
+                      <div class="cr-main">
+                        <div class="customer-name">{{ employee.tenNhanVien }}</div>
+                        <div class="customer-phone"><i class="fa-solid fa-envelope me-1"></i>{{ employee.email || '-' }}</div>
+                        <div class="customer-phone"><i class="fa-solid fa-phone me-1"></i>{{ employee.phone || '-' }}</div>
+                      </div>
+                    </div>
+                  </div>
+                  <div v-else-if="employeeSearchLoading" class="search-results empty">
+                    <div class="customer-result muted">
+                      <div class="cr-main">
+                        <div class="customer-name">Đang tìm nhân viên...</div>
+                        <div class="customer-phone">Vui lòng chờ</div>
+                      </div>
+                    </div>
+                  </div>
+                  <div v-else-if="employeeSearchError && employeeSearch.trim()" class="search-results empty">
+                    <div class="customer-result muted">
+                      <div class="cr-main">
+                        <div class="customer-name">{{ employeeSearchError }}</div>
+                        <div class="customer-phone">Thử nhập tên khác.</div>
+                      </div>
+                    </div>
+                  </div>
+
+                  <div v-if="selectedEmployee" class="selected-customer">
+                    <div class="customer-avatar">{{ initials(selectedEmployee.tenNhanVien) }}</div>
+                    <div class="min-w-0">
+                      <div class="customer-name">{{ selectedEmployee.tenNhanVien }}</div>
+                      <div class="customer-phone"><i class="fa-solid fa-envelope me-1"></i>{{ selectedEmployee.email || '-' }}</div>
+                      <div class="customer-phone"><i class="fa-solid fa-phone me-1"></i>{{ selectedEmployee.phone || '-' }}</div>
+                    </div>
+                    <button class="clear-btn" type="button" @click="clearSelectedEmployee">
+                      <i class="fa-solid fa-xmark"></i>
+                    </button>
+                  </div>
+                </div>
+              </div>
+
               <div class="section-title">
                 <i class="fa-solid fa-briefcase"></i>
                 Dịch vụ & giá trị
               </div>

               <div v-if="canFullBranch" class="field">
                 <label class="field-label">
                   <span class="label-ico tone-emerald"><i class="fa-solid fa-code-branch"></i></span>
                   <span>Chi nhánh</span>
                 </label>
                 <select v-model="newContract.branchId" :disabled="branchLoading">
                   <option v-for="branch in branchOptions" :key="branch.id" :value="branch.id">
                     {{ branch.label }}
                   </option>
                 </select>
                 <div class="muted tiny">Chọn chi nhánh áp dụng cho hợp đồng.</div>
               </div>

               <div class="field">
                 <label class="field-label">
                   <span class="label-ico tone-indigo"><i class="fa-solid fa-list"></i></span>
                   <span>Dịch vụ</span>
                 </label>
                 <select v-model="newContract.serviceId">
                   <option v-for="service in serviceOptions" :key="service.id || service.name" :value="service.id || service.name">
@@ -1306,60 +1396,70 @@ const nguoiTaoOptions = ref([])
 const nguoiChotOptions = ref([])

 // Filters
 const searchQuery = ref('')
 const filterService = ref(null)
 const filterBranch = ref(null)
 const filterStatus = ref(null)
 const filterNguoiTaoId = ref(null)
 const filterNguoiChotId = ref(null)
 const tuNgay = ref(null)
 const denNgay = ref(null)
 const currentPage = ref(1)
 const pageSize = ref(10)
 const currentUserName = ref('Nguyễn Minh')
 const searchTimer = ref(null)

 // Customer search
 const customerSearch = ref('')
 const selectedCustomer = ref(null)
 const customerSearchResults = ref([])
 const customerSearchLoading = ref(false)
 const customerSearchError = ref('')
 const customerSearchTimer = ref(null)
 const lastCustomerKeyword = ref('')
 const suppressCustomerSearch = ref(false)
+const nguoiChotMode = ref('SELF')
+const employeeSearch = ref('')
+const selectedEmployee = ref(null)
+const employeeSearchResults = ref([])
+const employeeSearchLoading = ref(false)
+const employeeSearchError = ref('')
+const employeeSearchTimer = ref(null)
+const lastEmployeeKeyword = ref('')
+const suppressEmployeeSearch = ref(false)
 const CONTRACT_DRAFT_KEY = 'contractDraftFromAppointment'

 // New contract form
 const newContract = ref({
   maHopDong: '',
   maKhachHang: '',
   tenKhachHang: '',
   tenDichVu: '',
   serviceId: null,
   branchId: null,
+  nguoiChotId: null,
   giaTriTaiSan: null,
   giaDichVuGoc: 0,
   phiGiam: 0,
   discountMode: 'PERCENT',
   discountValue: 0,
   giaSauGiam: 0,
   trangThaiHopDong: 'DANG_HIEU_LUC',
   ngayKy: todayISO(),
   initPlan: 'COC',
   tiLeCoc: 30,
   firstMethod: 'CHUYEN_KHOAN'
 })

 // Modals
 const showModal = ref(null)
 const currentContract = ref(null)
 const detailContract = ref(null)
 const openActionMenu = ref(null)
 const actionMenuPosition = ref({ top: 0, left: 0 })

 // Payment form
 const payment = ref({
   amount: 0,
   method: 'CHUYEN_KHOAN',
   date: todayISO(),
@@ -1404,50 +1504,59 @@ const toast = ref({
 const pageStart = computed(() => {
   if (!totalElements.value) return 0
   return (currentPage.value - 1) * pageSize.value + 1
 })

 const pageEnd = computed(() => {
   return Math.min(currentPage.value * pageSize.value, totalElements.value)
 })

 const totalDoanhThu = computed(() => {
   return contracts.value.reduce((sum, c) => sum + getDoanhThu(c), 0)
 })

 const totalDieuChinh = computed(() => {
   return contracts.value.reduce((sum, c) => sum + getTongDieuChinh(c), 0)
 })

 const totalDoanhSo = computed(() => {
   return contracts.value.reduce((sum, c) => sum + getDoanhSo(c), 0)
 })

 const serviceOptions = computed(() => {
   return services.value
 })

+const currentUserId = computed(() => info.value?.id ?? null)
+
+const nguoiChotDisplayName = computed(() => {
+  if (nguoiChotMode.value === 'SELF') {
+    return info.value?.fullName || 'Chưa có tên'
+  }
+  return selectedEmployee.value?.tenNhanVien || ''
+})
+
 const branchFilterOptions = computed(() => ([
   { id: null, label: 'Tất cả' },
   ...branchOptions.value
 ]))

 const selectedService = computed(() => {
   if (!newContract.value.serviceId) return null
   return serviceOptions.value.find(s => String(s.id || s.name) === String(newContract.value.serviceId)) || null
 })

 const matchingSegment = computed(() => {
   const serviceId = newContract.value.serviceId
   const assetValue = Number(newContract.value.giaTriTaiSan || 0)
   if (!serviceId || assetValue <= 0) return null
   return segments.value.find(seg =>
       String(seg.serviceId) === String(serviceId) &&
       assetValue >= Number(seg.min) &&
       assetValue < Number(seg.max)
   ) || null
 })

 const getDefaultBranchId = () => {
   if (canFullBranch.value) {
     const hasDraftMatch = draftBranchId.value && branchOptions.value.some(
       (branch) => String(branch.id) === String(draftBranchId.value)
@@ -1522,82 +1631,126 @@ watch(filterBranch, () => {

 watch(filterNguoiTaoId, () => {
   currentPage.value = 1
   fetchContracts()
 })

 watch(filterNguoiChotId, () => {
   currentPage.value = 1
   fetchContracts()
 })

 watch([tuNgay, denNgay], () => {
   currentPage.value = 1
   fetchContracts()
 })

 watch(currentPage, () => {
   fetchContracts()
 })

 watch(pageSize, () => {
   currentPage.value = 1
   fetchContracts()
 })

+watch([nguoiChotMode, currentUserId], ([mode, userId]) => {
+  if (mode === 'SELF') {
+    selectedEmployee.value = null
+    employeeSearch.value = ''
+    employeeSearchResults.value = []
+    employeeSearchError.value = ''
+    employeeSearchLoading.value = false
+    newContract.value.nguoiChotId = userId ?? null
+  } else {
+    newContract.value.nguoiChotId = selectedEmployee.value?.id ?? null
+  }
+}, { immediate: true })
+
 watch(customerSearch, (val) => {
   if (suppressCustomerSearch.value) return

   if (selectedCustomer.value && (val || '').trim() === (selectedCustomer.value.name || '').trim()) {
     customerSearchResults.value = []
     customerSearchLoading.value = false
     customerSearchError.value = ''
     return
   }

   if (selectedCustomer.value && (val || '').trim() !== (selectedCustomer.value?.name || '').trim()) {
     selectedCustomer.value = null
     newContract.value.maKhachHang = ''
     newContract.value.tenKhachHang = ''
   }

   clearCustomerSearchTimer()

   const k = (val || '').trim()
   if (!k) {
     lastCustomerKeyword.value = ''
     customerSearchResults.value = []
     customerSearchError.value = ''
     customerSearchLoading.value = false
     return
   }

   customerSearchTimer.value = setTimeout(() => {
     fetchCustomerSearch(k)
   }, 250)
 })

+watch(employeeSearch, (val) => {
+  if (suppressEmployeeSearch.value || nguoiChotMode.value !== 'OTHER') return
+
+  if (selectedEmployee.value && (val || '').trim() === (selectedEmployee.value.tenNhanVien || '').trim()) {
+    employeeSearchResults.value = []
+    employeeSearchLoading.value = false
+    employeeSearchError.value = ''
+    return
+  }
+
+  if (selectedEmployee.value && (val || '').trim() !== (selectedEmployee.value?.tenNhanVien || '').trim()) {
+    selectedEmployee.value = null
+    newContract.value.nguoiChotId = null
+  }
+
+  clearEmployeeSearchTimer()
+
+  const k = (val || '').trim()
+  if (!k) {
+    lastEmployeeKeyword.value = ''
+    employeeSearchResults.value = []
+    employeeSearchError.value = ''
+    employeeSearchLoading.value = false
+    return
+  }
+
+  employeeSearchTimer.value = setTimeout(() => {
+    fetchEmployeeOptions(k)
+  }, 250)
+})
+
 watch(() => newContract.value.serviceId, () => {
   updateServicePrice()
 })

 watch(() => newContract.value.giaTriTaiSan, () => {
   updateGiaGocFromAsset()
 })

 watch(() => newContract.value.discountMode, () => {
   updateGiaSauGiam()
 })

 watch(() => adjustment.value.serviceId, () => {
   updateAdjustmentServicePrice()
 })

 watch(() => adjustment.value.giaTriTaiSan, () => {
   updateAdjustmentGiaGocFromAsset()
 })

 watch(() => adjustment.value.discountMode, () => {
   updateAdjustmentGiaSauGiam()
 })
 const fetchBranchOptions = async () => {
   if (branchLoading.value) return
@@ -1724,50 +1877,59 @@ const formatNumberInput = (n) => {
   const abs = Math.abs(x)
   return sign + abs.toString().replace(/\B(?=(\d{3})+(?!\d))/g, '.')
 }

 const parseNumberInput = (value, allowNegative = false) => {
   const raw = String(value || '').trim()
   if (!raw) return 0
   const noDots = raw.replace(/\./g, '')
   const cleaned = allowNegative ? noDots.replace(/[^0-9-]/g, '') : noDots.replace(/[^0-9]/g, '')
   let parsed = Number(cleaned)
   if (Number.isNaN(parsed)) parsed = 0
   if (!allowNegative) return Math.max(0, parsed)
   return parsed
 }

 const initials = (name) => {
   const parts = String(name || '')
       .trim()
       .split(/\s+/)
       .filter(Boolean)
   if (parts.length === 0) return 'NA'
   if (parts.length === 1) return parts[0].slice(0, 2).toUpperCase()
   return (parts[0][0] + parts[parts.length - 1][0]).toUpperCase()
 }

+const EMPLOYEE_AVATAR_BASE = 'https://s3.cloudfly.vn/thg-storage-dev/uploads-public/'
+
+const getEmployeeAvatarUrl = (avatar) => {
+  const raw = String(avatar || '').trim()
+  if (!raw) return ''
+  if (/^https?:\/\//.test(raw)) return raw
+  return `${EMPLOYEE_AVATAR_BASE}${raw}`
+}
+
 const getStatusText = (status) => {
   switch(status) {
     case 'DANG_HIEU_LUC': return 'Đang hiệu lực'
     case 'HOAN_TAT': return 'Hoàn tất'
     case 'HUY': return 'Đã hủy'
     default: return status
   }
 }

 const getHienTrangInfo = (contract, useRow = false) => {
   const doanhThu = useRow ? getDoanhThuRow(contract) : getDoanhThu(contract)
   const doanhSo = useRow ? getDoanhSoRow(contract) : getDoanhSo(contract)
   const diff = Number(doanhSo) - Number(doanhThu)
   if (diff > 0) {
     return { label: 'Công nợ', icon: 'fa-solid fa-triangle-exclamation', class: 'st-debt', amount: diff }
   }
   if (diff < 0) {
     return { label: 'Thu lố', icon: 'fa-solid fa-arrow-rotate-left', class: 'st-over', amount: Math.abs(diff) }
   }
   return { label: 'Đã thu đủ', icon: 'fa-solid fa-circle-check', class: 'st-balance', amount: null }
 }



 const formatCreatedAt = (value) => {
@@ -2108,57 +2270,64 @@ const calcConThieu = (c) => {
 }

 const getMaxRefundAmount = (c) => {
   return Math.max(0, getDoanhThuRow(c))
 }

 // Modal control
 const openModal = (modal) => {
   showModal.value = modal
 }

 const closeModal = (modal) => {
   resetContractForm()
   if (showModal.value === modal) {
     showModal.value = null
   }
   if (modal === 'modalDetail') {
     detailContract.value = null
   }
 }

 // Contract management
 const resetContractForm = () => {
   const firstService = serviceOptions.value[0] || null
   draftBranchId.value = null
+  nguoiChotMode.value = 'SELF'
+  selectedEmployee.value = null
+  employeeSearch.value = ''
+  employeeSearchResults.value = []
+  employeeSearchError.value = ''
+  employeeSearchLoading.value = false
   newContract.value = {
     maHopDong: genContractCode(),
     maKhachHang: '',
     tenKhachHang: '',
     tenDichVu: firstService?.name || '',
     serviceId: firstService?.id || firstService?.name || null,
     branchId: getDefaultBranchId(),
+    nguoiChotId: currentUserId.value ?? null,
     giaTriTaiSan: null,
     giaDichVuGoc: 0,
     phiGiam: 0,
     discountMode: 'PERCENT',
     discountValue: 0,
     giaSauGiam: 0,
     trangThaiHopDong: 'DANG_HIEU_LUC',
     ngayKy: todayISO(),
     initPlan: 'COC',
     tiLeCoc: 30,
     firstMethod: 'CHUYEN_KHOAN'
   }
   customerSearch.value = ''
   selectedCustomer.value = null
   customerSearchResults.value = []
   customerSearchError.value = ''
   customerSearchLoading.value = false
   updateServicePrice()
 }

 const updateServicePrice = () => {
   const service = getServiceById(newContract.value.serviceId)
   newContract.value.tenDichVu = service?.name || ''
   updateGiaGocFromAsset()
 }
@@ -2243,157 +2412,228 @@ const setAdjustmentDiscountValueFromInput = (value) => {
   updateAdjustmentGiaSauGiam()
 }

 const setPaymentAmountFromInput = (value) => {
   const parsed = parseNumberInput(value)
   const maxAmount = calcConThieu(currentContract.value)
   payment.value.amount = Math.min(parsed, maxAmount)
 }

 const setRefundAmountFromInput = (value) => {
   const parsed = parseNumberInput(value)
   const maxAmount = getMaxRefundAmount(currentContract.value)
   refund.value.amount = Math.min(parsed, maxAmount)
 }

 const clearSelectedCustomer = () => {
   selectedCustomer.value = null
   customerSearch.value = ''
   customerSearchResults.value = []
   customerSearchError.value = ''
   customerSearchLoading.value = false
   newContract.value.maKhachHang = ''
   newContract.value.tenKhachHang = ''
 }

+const clearSelectedEmployee = () => {
+  selectedEmployee.value = null
+  employeeSearch.value = ''
+  employeeSearchResults.value = []
+  employeeSearchError.value = ''
+  employeeSearchLoading.value = false
+  newContract.value.nguoiChotId = null
+}
+
 const fetchCustomerSearch = async (keyword) => {
   const k = (keyword || '').trim()
   if (!k) {
     customerSearchResults.value = []
     customerSearchError.value = ''
     return
   }

   if (k === lastCustomerKeyword.value) return
   lastCustomerKeyword.value = k

   customerSearchLoading.value = true
   customerSearchError.value = ''

   try {
     const qs = new URLSearchParams({ keyword: k }).toString()
     const res = await api.get(`/customer-crm/admin/lich-hen/search-customer?${qs}`)
     const data = await res.data
     customerSearchResults.value = (Array.isArray(data) ? data : []).slice(0, 8).map((x) => ({
       id: x.customerId,
       name: x.customerName,
       phone: x.phone,
       raw: x
     }))
   } catch (e) {
     customerSearchResults.value = []
     customerSearchError.value = 'Không tìm thấy hoặc lỗi tải dữ liệu.'
   } finally {
     customerSearchLoading.value = false
   }
 }

+const fetchEmployeeOptions = async (keyword) => {
+  const k = (keyword || '').trim()
+  if (!k) {
+    employeeSearchResults.value = []
+    employeeSearchError.value = ''
+    return
+  }
+
+  if (k === lastEmployeeKeyword.value) return
+  lastEmployeeKeyword.value = k
+
+  employeeSearchLoading.value = true
+  employeeSearchError.value = ''
+
+  try {
+    const res = await api.get('/employee-options', {
+      params: { search: k }
+    })
+    const data = res?.data
+    employeeSearchResults.value = (Array.isArray(data) ? data : []).slice(0, 8).map((item) => ({
+      id: item.id,
+      tenNhanVien: item.tenNhanVien,
+      avatar: item.avatar,
+      email: item.email,
+      phone: item.phone
+    }))
+  } catch (e) {
+    employeeSearchResults.value = []
+    employeeSearchError.value = 'Không tìm thấy hoặc lỗi tải dữ liệu.'
+  } finally {
+    employeeSearchLoading.value = false
+  }
+}
+
 const clearCustomerSearchTimer = () => {
   if (customerSearchTimer.value) clearTimeout(customerSearchTimer.value)
   customerSearchTimer.value = null
 }

+const clearEmployeeSearchTimer = () => {
+  if (employeeSearchTimer.value) clearTimeout(employeeSearchTimer.value)
+  employeeSearchTimer.value = null
+}
+
 const selectCustomer = (customer) => {
   suppressCustomerSearch.value = true
   clearCustomerSearchTimer()
   customerSearchLoading.value = false
   customerSearchError.value = ''
   customerSearchResults.value = []

   selectedCustomer.value = customer
   customerSearch.value = customer.name
   newContract.value.maKhachHang = customer.id
   newContract.value.tenKhachHang = customer.name
   if (customer?.raw?.giaTriTaiSan !== undefined && customer?.raw?.giaTriTaiSan !== null) {
     newContract.value.giaTriTaiSan = Number(customer.raw.giaTriTaiSan || 0)
   }

   setTimeout(() => {
     suppressCustomerSearch.value = false
   }, 0)
 }

+const selectEmployee = (employee) => {
+  suppressEmployeeSearch.value = true
+  clearEmployeeSearchTimer()
+  employeeSearchLoading.value = false
+  employeeSearchError.value = ''
+  employeeSearchResults.value = []
+
+  selectedEmployee.value = employee
+  employeeSearch.value = employee.tenNhanVien
+  newContract.value.nguoiChotId = employee.id
+
+  setTimeout(() => {
+    suppressEmployeeSearch.value = false
+  }, 0)
+}
+
 const saveContract = async () => {
   updateGiaSauGiam()
   if (!selectedCustomer.value) {
     showError('Thiếu dữ liệu', 'Bạn cần chọn khách hàng từ danh sách.')
     return
   }

   if (!newContract.value.tenDichVu) {
     showError('Thiếu dữ liệu', 'Bạn cần chọn Dịch vụ.')
     return
   }

   if (!newContract.value.giaTriTaiSan) {
     showError('Thiếu dữ liệu', 'Bạn cần nhập giá trị tài sản.')
     return
   }

   if (!newContract.value.giaDichVuGoc) {
     showError('Thiếu dữ liệu', 'Giá gốc chưa xác định theo phân khúc.')
     return
   }

   if (newContract.value.discountMode === 'MONEY' && newContract.value.discountValue <= 0) {
     showError('Giảm giá không hợp lệ', 'Giảm giá tiền phải > 0 và không vượt quá giá gốc.')
     return
   }

+  if (nguoiChotMode.value === 'OTHER' && !selectedEmployee.value) {
+    showError('Thiếu dữ liệu', 'Bạn cần chọn nhân viên chốt hợp đồng.')
+    return
+  }
+
   const payload = {
     maKhachHang: newContract.value.maKhachHang,
     giaTriKyBan: newContract.value.giaTriTaiSan,
     giaDichVuGoc: newContract.value.giaDichVuGoc,
     phiGiam: newContract.value.phiGiam || 0,
     giaSauGiam: newContract.value.giaSauGiam,
     hinhThucThanhToan: newContract.value.firstMethod,
     serviceId: newContract.value.serviceId,
     branchId: newContract.value.branchId ?? null,
+    nguoiChotId: newContract.value.nguoiChotId ?? null,
     soTienThanhToan: firstPaymentAmount.value,
     initPlan: newContract.value.initPlan
   }

   try {
     const res = await showLoading(api.post('/hop-dong/admin/create', payload))
     const created = res?.data || {}
     const hasPayments = Array.isArray(created.dotDongTien) && created.dotDongTien.length > 0
     const contract = {
       id: created.id || crypto.randomUUID(),
       maHopDong: created.maHopDong || newContract.value.maHopDong,
       maKhachHang: created.maKhachHang ?? newContract.value.maKhachHang,
       tenKhachHang: created.tenKhachHang || newContract.value.tenKhachHang,
       nhanVienTao: created.nhanVienTao || currentUserName.value,
+      tenNhanVienChot: created.tenNhanVienChot || nguoiChotDisplayName.value || '-',
       tenDichVu: created.tenDichVu || newContract.value.tenDichVu,
       serviceId: created.serviceId ?? newContract.value.serviceId,
       giaTriTaiSan: created.giaTriKyBan ?? created.giaTriTaiSan ?? newContract.value.giaTriTaiSan,
       giaDichVuGoc: created.giaDichVuGoc ?? newContract.value.giaDichVuGoc,
       phiGiam: created.phiGiam ?? newContract.value.phiGiam ?? 0,
       giaSauGiam: created.giaSauGiam ?? newContract.value.giaSauGiam,
       trangThaiHopDong: created.trangThaiHopDong ?? newContract.value.trangThaiHopDong,
       ngayKy: created.ngayKy ?? newContract.value.ngayKy ?? todayISO(),
       ngayTao: created.ngayTao ?? new Date().toLocaleString('vi-VN'),
       dotDongTien: hasPayments ? created.dotDongTien : [],
       hoanTien: created.hoanTien || [],
       dieuChinh: created.dieuChinh || [],
       initPlan: created.initPlan ?? newContract.value.initPlan,
       tiLeCoc: created.tiLeCoc ?? (newContract.value.initPlan === 'COC' ? (newContract.value.tiLeCoc || 0) : null)
     }

     if (!hasPayments && firstPaymentAmount.value > 0) {
       contract.dotDongTien.push({
         id: crypto.randomUUID(),
         soTienDong: firstPaymentAmount.value,
         hinhThucThanhToan: newContract.value.firstMethod,
         ngayDongTien: contract.ngayKy,
         ghiChu: newContract.value.initPlan === 'FULL' ?
             'Thanh toán đủ (tạo khi lập HĐ)' :
             `Cọc ${newContract.value.tiLeCoc || 0}% (tạo khi lập HĐ)`,
