diff --git a/src/components/Appointments/AppointmentsPage.vue b/src/components/Appointments/AppointmentsPage.vue
index e23aa9c37da364dcba2ff8b0aa89b6cfc5dbf0d8..d8684aae8fffa284a70a4062376b8ed921486107 100644
--- a/src/components/Appointments/AppointmentsPage.vue
+++ b/src/components/Appointments/AppointmentsPage.vue
@@ -114,50 +114,64 @@ function showToast(title, body, type = 'info') {
   t.innerHTML = `
       <div class="ico"><i class="fa-solid ${icon}"></i></div>
       <div class="t">
         <div class="a">${title}</div>
         <div class="b">${body || ''}</div>
       </div>
       <button class="x" aria-label="close"><i class="fa-solid fa-xmark"></i></button>
     `;
   wrap.appendChild(t);

   const kill = () => {
     t.remove();
   };
   t.querySelector('.x').addEventListener('click', kill);
   setTimeout(kill, 3800);
 }

 const demoToday = new Date(2026, 0, 3);
 const selectedDateISO = ref('2026-01-03');
 const calendarMonth = ref(new Date(2026, 0, 1));

 const activeRange = ref('all');
 const activeStatus = ref('ALL');
 const searchQuery = ref('');
 const editId = ref(null);
+const isModalOpen = ref(false);
+const modalForm = reactive({
+  customer: '',
+  phone: '',
+  date: '',
+  time: TIME_SLOTS[0],
+  staff: STAFFS[0],
+  consultant: CONSULTANTS[0],
+  status: 'UP',
+  consultStatus: 'CARE',
+  customerType: 'OWNER',
+  rating: 'CARE',
+  note: '',
+});

 function makeHistory(actor, action, desc) {
   return { ts: nowISO(), actor, action, desc };
 }

 const appointments = ref([
   {
     id: 1,
     customer: 'Nguyễn Văn A',
     phone: '0987 654 321',
     date: '2026-01-03',
     time: '10:00',
     staff: 'Lê Hiếu',
     consultant: 'Tư vấn 1',
     status: 'UP',
     consultStatus: 'SUCCESS',
     customerType: 'OWNER',
     rating: 'POTENTIAL',
     creator: 'Lê Hiếu',
     note: 'Khách ưu tiên làm nhanh.',
     history: [makeHistory('Lê Hiếu', 'CREATE', 'Tạo lịch hẹn.')],
   },
   {
     id: 2,
     customer: 'Trần Thị B',
@@ -640,98 +654,92 @@ function saveFromForm() {
   selectedDateISO.value = date;
   $('#fDate').value = date;

   showToast('Đã tạo lịch hẹn', `${customer}: ${formatVNDate(date)} • ${time}`, 'success');
   generateCalendar();
   updateDaySchedule();
   updateFilteredAppointments();
   resetForm();
 }

 function renderHistory(appt) {
   const history = (appt.history || []).slice(0, 80);
   historyItems.value = history.map((h) => {
     const dt = new Date(h.ts);
     const stamp = `${pad2(dt.getHours())}:${pad2(dt.getMinutes())} • ${pad2(dt.getDate())}/${pad2(dt.getMonth() + 1)}/${dt.getFullYear()}`;
     return { ...h, stamp };
   });
 }

 function openModal(id) {
   const appt = appointments.value.find((x) => x.id === id);
   if (!appt) return;

   editId.value = id;

-  $('#mCustomer').value = appt.customer || '';
-  $('#mPhone').value = appt.phone || '';
-  $('#mDate').value = appt.date;
-
-  $('#mTime').innerHTML = TIME_SLOTS.map((t) => `<option value="${t}">${t}</option>`).join('');
-  $('#mTime').value = appt.time;
-
-  fillSelect($('#mStaff'), STAFFS, appt.staff);
-  fillSelect($('#mConsultant'), CONSULTANTS, appt.consultant);
-
-  $('#mStatus').value = appt.status;
-  $('#mConsultStatus').value = appt.consultStatus || 'CARE';
-  $('#mCustomerType').value = appt.customerType || 'OWNER';
-  $('#mRating').value = appt.rating || 'CARE';
-  $('#mNote').value = appt.note || '';
+  modalForm.customer = appt.customer || '';
+  modalForm.phone = appt.phone || '';
+  modalForm.date = appt.date;
+  modalForm.time = TIME_SLOTS.includes(appt.time) ? appt.time : TIME_SLOTS[0];
+  modalForm.staff = STAFFS.includes(appt.staff) ? appt.staff : STAFFS[0];
+  modalForm.consultant = CONSULTANTS.includes(appt.consultant) ? appt.consultant : CONSULTANTS[0];
+  modalForm.status = appt.status;
+  modalForm.consultStatus = appt.consultStatus || 'CARE';
+  modalForm.customerType = appt.customerType || 'OWNER';
+  modalForm.rating = appt.rating || 'CARE';
+  modalForm.note = appt.note || '';

   renderHistory(appt);

-  $('#modalBackdrop').classList.add('open');
-  $('#modalBackdrop').setAttribute('aria-hidden', 'false');
+  isModalOpen.value = true;
 }

 function closeModal() {
-  $('#modalBackdrop').classList.remove('open');
-  $('#modalBackdrop').setAttribute('aria-hidden', 'true');
+  isModalOpen.value = false;
   editId.value = null;
 }

 function saveModal() {
   if (editId.value == null) return;
   const idx = appointments.value.findIndex((x) => x.id === editId.value);
   if (idx < 0) return;

   const current = appointments.value[idx];

   const next = {
     ...current,
-    customer: $('#mCustomer').value.trim() || current.customer,
-    phone: $('#mPhone').value.trim(),
-    date: $('#mDate').value,
-    time: $('#mTime').value,
-    staff: $('#mStaff').value,
-    consultant: $('#mConsultant').value,
-    status: $('#mStatus').value,
-    consultStatus: $('#mConsultStatus').value,
-    customerType: $('#mCustomerType').value,
-    rating: $('#mRating').value,
-    note: $('#mNote').value.trim(),
+    customer: modalForm.customer.trim() || current.customer,
+    phone: modalForm.phone.trim(),
+    date: modalForm.date,
+    time: modalForm.time,
+    staff: modalForm.staff,
+    consultant: modalForm.consultant,
+    status: modalForm.status,
+    consultStatus: modalForm.consultStatus,
+    customerType: modalForm.customerType,
+    rating: modalForm.rating,
+    note: modalForm.note.trim(),
   };

   if (next.status !== 'CANCELLED') {
     const conflict = hasConflict({ id: next.id, date: next.date, time: next.time, staff: next.staff });
     if (conflict) {
       showToast(
         'Trùng lịch theo nhân viên',
         `${next.staff} đã có lịch ${formatVNDate(conflict.date)} • ${conflict.time} với ${conflict.customer}.`,
         'error',
       );
       return;
     }
   }

   const changes = [];
   if (current.date !== next.date || current.time !== next.time) {
     changes.push(`Dời lịch: ${formatVNDate(current.date)} • ${current.time} → ${formatVNDate(next.date)} • ${next.time}.`);
   }
   if (current.staff !== next.staff) {
     changes.push(`Đổi NV phụ trách: ${current.staff} → ${next.staff}.`);
   }
   if (current.consultant !== next.consultant) {
     changes.push(`Đổi NV tư vấn: ${current.consultant || '-'} → ${next.consultant || '-'}.`);
   }
   if (current.status !== next.status) {
@@ -894,138 +902,127 @@ function initFormButtons() {
 }

 function initCalendarNav() {
   $('#prevMonthBtn').addEventListener('click', () => {
     calendarMonth.value = new Date(calendarMonth.value.getFullYear(), calendarMonth.value.getMonth() - 1, 1);
     generateCalendar();
   });
   $('#nextMonthBtn').addEventListener('click', () => {
     calendarMonth.value = new Date(calendarMonth.value.getFullYear(), calendarMonth.value.getMonth() + 1, 1);
     generateCalendar();
   });
 }

 function initDayButtons() {
   $('#jumpToFormBtn').addEventListener('click', () => {
     $('#fDate').value = selectedDateISO.value;
     $('#formSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
     highlightForm();
   });
   $('#refreshDayBtn').addEventListener('click', () => {
     updateDaySchedule();
     showToast('Đã làm mới', `Day Schedule • ${formatVNDate(selectedDateISO.value)}`, 'success');
   });
 }

-function initModal() {
-  $('#modalCloseBtn').addEventListener('click', closeModal);
-  $('#modalCancelBtn').addEventListener('click', closeModal);
-  $('#modalSaveBtn').addEventListener('click', saveModal);
-  $('#modalBackdrop').addEventListener('click', (e) => {
-    if (e.target === $('#modalBackdrop')) closeModal();
-  });
-
-  const closeOnEscape = (e) => {
-    if (e.key === 'Escape') closeModal();
-  };
-  registerWindowListener('keydown', closeOnEscape);
-}
-
 function initExport() {
   $('#exportBtn').addEventListener('click', exportCSV);
 }

 function toggleActionMenu(id) {
   openActionMenuId.value = openActionMenuId.value === id ? null : id;
 }

 function handleAction(type, appt, event) {
   openActionMenuId.value = null;
   if (type === 'edit') {
     openModal(appt.id);
   } else if (type === 'status') {
     openStatusPopover(event.currentTarget, appt.id);
   } else if (type === 'delete') {
     appointments.value = appointments.value.filter((x) => x.id !== appt.id);
     generateCalendar();
     updateDaySchedule();
     updateFilteredAppointments();
     showToast('Đã xoá lịch hẹn', appt.customer || 'Đã xoá.', 'success');
   }
 }

 function getStatusInfo(status) {
   return STATUS[status];
 }

 function getConsultInfo(status) {
   return CONSULT_STATUS[status] || CONSULT_STATUS.CARE;
 }

 function getCustomerTypeInfo(value) {
   return CUSTOMER_TYPE[value] || Object.values(CUSTOMER_TYPE)[0];
 }

 function getRatingInfo(value) {
   return RATING[value] || Object.values(RATING)[0];
 }

 onMounted(() => {
   if (!rootRef.value) return;

   selectedDateISO.value = '2026-01-03';
   $('#fDate').value = selectedDateISO.value;

   fillSelect($('#fStaff'), STAFFS, 'Lê Hiếu');
   fillSelect($('#fConsultant'), CONSULTANTS, 'Tư vấn 1');
-  fillSelect($('#mStaff'), STAFFS, 'Lê Hiếu');
-  fillSelect($('#mConsultant'), CONSULTANTS, 'Tư vấn 1');

   initTimeSelection();
   initStatusSelection();
   initConsultSelection();
   initStatusFilter();
   initFilterTabs();
   initSearch();
   initCreateBtn();
   initFormButtons();
   initCalendarNav();
   initDayButtons();
-  initModal();
   initExport();

   registerWindowListener('click', (e) => {
     if (!e.target.closest('[data-action-menu="1"]') && !e.target.closest('[data-action-btn="1"]')) {
       openActionMenuId.value = null;
     }
   });

   generateCalendar();
   updateDaySchedule();
   updateFilteredAppointments();

   showToast('Sẵn sàng', 'Đã thêm NV tư vấn + KQ tư vấn + phân loại + đánh giá.', 'success');
+
+  registerWindowListener('keydown', (e) => {
+    if (e.key === 'Escape' && isModalOpen.value) {
+      closeModal();
+    }
+  });
 });

 onBeforeUnmount(() => {
   cleanupHandlers.forEach((cleanup) => cleanup());
 });
 </script>

 <template>
   <div ref="rootRef" class="appointments-page">
     <div class="toast-wrap" id="toastWrap"></div>

     <div class="appointments-container">
       <main class="main-content">
         <div class="header">
           <div class="page-title">
             <h2>Quản lý lịch hẹn</h2>
             <p>Tạo, theo dõi và cập nhật trạng thái + tư vấn + phân loại + đánh giá</p>
           </div>

           <div class="search-bar">
             <i class="fas fa-search search-icon"></i>
             <input id="searchInput" type="text" placeholder="Tìm theo tên / SĐT / NV phụ trách / NV tư vấn..." />
           </div>
         </div>

@@ -1367,153 +1364,165 @@ onBeforeUnmount(() => {
           </div>
         </section>
       </main>
     </div>

     <div
       class="status-pop"
       id="statusPopover"
       :class="{ open: statusPopover.open }"
       :style="{ top: statusPopover.top, left: statusPopover.left }"
     >
       <button
         v-for="option in statusPopover.options"
         :key="option.key"
         class="opt"
         @click.stop="handleStatusOptionClick(option)"
       >
         <span>{{ option.label }}</span>
         <span
           class="dot"
           :style="{ background: option.dot, boxShadow: option.active ? '0 0 0 3px rgba(15,23,42,.06)' : '' }"
         ></span>
       </button>
     </div>

-    <div class="backdrop" id="modalBackdrop" aria-hidden="true">
+    <div v-if="isModalOpen" class="backdrop open" id="modalBackdrop" aria-hidden="false" @click.self="closeModal">
       <div class="modal" role="dialog" aria-modal="true">
         <div class="modal-head">
           <h4 id="modalTitle">Sửa lịch hẹn</h4>
-          <button class="modal-close" id="modalCloseBtn"><i class="fa-solid fa-xmark"></i></button>
+          <button class="modal-close" type="button" @click="closeModal">
+            <i class="fa-solid fa-xmark"></i>
+          </button>
         </div>

         <div class="modal-body">
           <div>
             <div class="form-grid">
               <div class="form-group">
                 <label class="form-label">Khách hàng</label>
-                <input id="mCustomer" type="text" class="form-input" />
+                <input id="mCustomer" v-model="modalForm.customer" type="text" class="form-input" />
               </div>
               <div class="form-group">
                 <label class="form-label">Số điện thoại</label>
-                <input id="mPhone" type="text" class="form-input" />
+                <input id="mPhone" v-model="modalForm.phone" type="text" class="form-input" />
               </div>

               <div class="form-group">
                 <label class="form-label">Ngày hẹn</label>
-                <input id="mDate" type="date" class="form-input" />
+                <input id="mDate" v-model="modalForm.date" type="date" class="form-input" />
               </div>
               <div class="form-group">
                 <label class="form-label">Giờ hẹn</label>
-                <select id="mTime" class="form-select"></select>
+                <select id="mTime" v-model="modalForm.time" class="form-select">
+                  <option v-for="slot in TIME_SLOTS" :key="slot" :value="slot">{{ slot }}</option>
+                </select>
               </div>

               <div class="form-group">
                 <label class="form-label">NV phụ trách</label>
-                <select id="mStaff" class="form-select"></select>
+                <select id="mStaff" v-model="modalForm.staff" class="form-select">
+                  <option v-for="staff in STAFFS" :key="staff" :value="staff">{{ staff }}</option>
+                </select>
               </div>
               <div class="form-group">
                 <label class="form-label">NV tư vấn</label>
-                <select id="mConsultant" class="form-select"></select>
+                <select id="mConsultant" v-model="modalForm.consultant" class="form-select">
+                  <option v-for="consultant in CONSULTANTS" :key="consultant" :value="consultant">
+                    {{ consultant }}
+                  </option>
+                </select>
               </div>

               <div class="form-group">
                 <label class="form-label">Tình trạng (đến lịch)</label>
-                <select id="mStatus" class="form-select">
+                <select id="mStatus" v-model="modalForm.status" class="form-select">
                   <option value="UP">Đã lên</option>
                   <option value="NOT_UP">Chưa lên</option>
                   <option value="POSTPONED">Tạm hoãn</option>
                   <option value="CANCELLED">Huỷ</option>
                 </select>
               </div>

               <div class="form-group">
                 <label class="form-label">Tình trạng tư vấn</label>
-                <select id="mConsultStatus" class="form-select">
+                <select id="mConsultStatus" v-model="modalForm.consultStatus" class="form-select">
                   <option value="SUCCESS">Thành công</option>
                   <option value="FAIL">Thất bại</option>
                   <option value="CARE">Chăm sóc</option>
                 </select>
               </div>

               <div class="form-group">
                 <label class="form-label">Phân loại khách hàng</label>
-                <select id="mCustomerType" class="form-select">
+                <select id="mCustomerType" v-model="modalForm.customerType" class="form-select">
                   <option value="OWNER">Chính chủ</option>
                   <option value="BROKER">Môi giới</option>
                   <option value="RELATIVE">Người thân</option>
                 </select>
               </div>

               <div class="form-group">
                 <label class="form-label">Đánh giá</label>
-                <select id="mRating" class="form-select">
+                <select id="mRating" v-model="modalForm.rating" class="form-select">
                   <option value="POTENTIAL">Tiềm năng</option>
                   <option value="NOT_POTENTIAL">Không tiềm năng</option>
                   <option value="CARE">Chăm sóc</option>
                 </select>
               </div>
             </div>

             <div class="form-group">
               <label class="form-label">Ghi chú</label>
-              <textarea id="mNote" class="form-textarea"></textarea>
+              <textarea id="mNote" v-model="modalForm.note" class="form-textarea"></textarea>
             </div>
           </div>

           <div class="modal-panel">
             <h5><i class="fa-solid fa-clock-rotate-left"></i>Lịch sử thay đổi</h5>
             <div class="history" id="historyList">
               <div v-if="!historyItems.length" style="font-weight:800; color:#94a3b8; font-size:12.5px;">
                 Chưa có lịch sử.
               </div>
               <div v-else>
                 <div v-for="item in historyItems" :key="item.ts" class="h-item">
                   <div class="h-top">
                     <span>{{ item.actor }} • {{ item.action }}</span>
                     <span>{{ item.stamp }}</span>
                   </div>
                   <div class="h-desc">{{ item.desc || '' }}</div>
                 </div>
               </div>
             </div>
           </div>
         </div>

         <div class="modal-foot">
-          <button class="btn btn-secondary" id="modalCancelBtn">Đóng</button>
-          <button class="btn btn-primary" id="modalSaveBtn"><i class="fa-solid fa-floppy-disk"></i>Lưu thay đổi</button>
+          <button class="btn btn-secondary" type="button" @click="closeModal">Đóng</button>
+          <button class="btn btn-primary" type="button" @click="saveModal">
+            <i class="fa-solid fa-floppy-disk"></i>Lưu thay đổi
+          </button>
         </div>
       </div>
     </div>
   </div>
 </template>

 <style scoped>
 @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

 .appointments-page{
   min-height:100vh;
   background:#f5f7fa;
   color:#0f172a;
   line-height:1.6;
 }

 *{ margin:0; padding:0; box-sizing:border-box; font-family:'Inter', sans-serif; }

 .appointments-container{ min-height:100vh; }

 /* Main */
 .main-content{ width:100%; padding:22px; }
 .header{
   display:flex; justify-content:space-between; align-items:center;
   margin-bottom:18px; gap:16px; flex-wrap:wrap;
