diff --git a/src/components/thiet-kegiandien/AppointmentsPage.vue b/src/components/thiet-kegiandien/AppointmentsPage.vue
index 18024581f4b2bd843a4186733ace63d05b670a47..28a1ffea59dceb31e10bceeea6051d378a4adc01 100644
--- a/src/components/thiet-kegiandien/AppointmentsPage.vue
+++ b/src/components/thiet-kegiandien/AppointmentsPage.vue
@@ -580,50 +580,54 @@ async function fetchAppointments() {

   generateCalendar()
   updateDaySchedule()
   updateFilterOutputs()
 }

 async function fetchStatsAppointments() {
   const { startDate, endDate } = getFilterRange()
   const payload = {
     startDate,
     endDate,
     status: null,
     search: null,
   }

   try {
     const res = await api.post('/customer-crm/admin/lich-hen/filter', payload)
     const data = Array.isArray(res.data) ? res.data : []
     statsAppointments.value = data.map(mapAppointmentFromApi)
   } catch (e) {
     statsAppointments.value = []
     showToast('Lỗi tải thống kê', e?.response?.data?.message || 'Không thể tải dữ liệu.', 'error')
   }
 }

+async function refreshAppointmentsAndStats() {
+  await Promise.all([fetchAppointments(), fetchStatsAppointments()])
+}
+
 function handleCalendarClick(cell) {
   if (!cell.currentMonth || !cell.iso) return
   if (!cell.enabled) return

   selectedDateISO.value = cell.iso
   updateDaySchedule()
   updateFilterOutputs()
   generateCalendar()
 }

 function handleMonthNav(dir) {
   if (activeRange.value !== 'month') return
   const y = calendarMonth.value.getFullYear()
   const m = calendarMonth.value.getMonth()
   const next = new Date(y, m + dir, 1)
   calendarMonth.value = next
   const nextISO = `${next.getFullYear()}-${pad2(next.getMonth() + 1)}-01`
   selectedDateISO.value = nextISO
   generateCalendar()
   updateDaySchedule()
   updateFilterOutputs()
 }

 // ===== Day schedule (ăn theo selectedDate + filter range disable) =====
 function apptsForSelectedDay() {
@@ -679,51 +683,51 @@ async function handleDrop(e, targetTime) {
     return
   }

   // chỉ cho đổi trong ngày đang chọn
   if (!isCellEnabled(selectedDateISO.value)) return

   if (appt.date === selectedDateISO.value && appt.time === targetTime) return

   try {
     const payload = {
       appointmentId: appt.id,
       appointmentDate: selectedDateISO.value,
       appointmentTime: targetTime, // String HH:mm
     }

     const res = await showLoading(
         api.post('/customer-crm/admin/lich-hen/update-time', payload)
     )

     if (!res.data.success) {
       updateAlertError('Không thể dời giờ', res.data.message)
       return
     }

     // ✅ CHỈ SAU KHI BE OK → reload
-    await fetchAppointments()
+    await refreshAppointmentsAndStats()

     updateAlertSuccess(
         'Đã dời giờ hẹn',
         `${appt.customer}: ${formatVNDate(appt.date)} → ${targetTime}`
     )
   } catch (e) {
     console.error(e)
     showToast(
         'Lỗi dời giờ',
         e?.response?.data?.message || 'Không thể cập nhật giờ hẹn.',
         'error'
     )
   }
 }

 // ===== Customer search =====
 // ===== Customer search (CALL API) =====
 let suppressCustomerSearch = false
 const customerSearchResults = ref([])
 const customerSearchLoading = ref(false)
 const customerSearchError = ref('')

 let customerSearchTimer = null
 let lastCustomerKeyword = ''

@@ -926,50 +930,51 @@ async function saveEditModal() {

   const payload = {
     appointmentId: editId.value,
     branchId: editForm.branch,
     appointmentDate: editForm.date,
     appointmentTime: editForm.time,
     consultantId: editForm.consultantId,
     status: editForm.status,
     rating: editForm.rating,
     consultStatus: editForm.consultStatus || null, // ✅ thêm
     note: editForm.note?.trim(),
     customerNote: editForm.customerNote?.trim(),
     updateReason: editForm.updateReason?.trim(),
   }

   console.log('Update appointment payload', payload)

   try {
     const res = await showLoading( api.post(
         '/customer-crm/admin/lich-hen/update',
         payload
     ));

     if (res.data.success) {
       updateAlertSuccess('✅ Cập nhật lịch hẹn thành công')
+      await refreshAppointmentsAndStats()
       closeEditModal()
       // reload list / calendar nếu cần
     } else {
       updateAlertError('❌ Cập nhật thất bại:', res.data.message)
       alert(res.data.message)
     }
   } catch (e) {
     console.error('❌ Lỗi gọi API update lịch hẹn', e)
   }
 }
 // ===== Lấy tất cả chi nhánh =========
 // ===== Branch options (API) =====
 const BRANCHES = ref([])
 const branchLoading = ref(false)

 async function fetchBranchOptions() {
   if (branchLoading.value) return

   branchLoading.value = true
   try {
     const res = await api.get('/customer-crm/admin/lich-hen/options')

     // BE trả: [{ id, address }]
     BRANCHES.value = (Array.isArray(res.data) ? res.data : []).map(b => ({
       key: Number(b.id),      // đảm bảo là number
@@ -1160,51 +1165,51 @@ async function saveNewAppointment() {
   if (!createForm.consultant) {
     showCenterWarning('Thiếu thông tin', 'Vui lòng chọn NV tư vấn.', 'error')
     return
   }

   const timeCheck = isValidAppointmentTime(
       createForm.date,
       createForm.time
   )

   if (!timeCheck.valid) {
     showCenterWarning('Thời gian không hợp lệ', timeCheck.message, 'error')
     return
   }

   try {
     const res = await showLoading(createAppointmentApi());

     if( !res.data.success) {
       updateAlertError('Không thể tạo lịch hẹn', res.data.message || 'Có lỗi xảy ra, vui lòng thử lại.', 'error')
       return
     }

     updateAlertSuccess('Tạo lịch hẹn thành công', 'Lịch hẹn đã được tạo.')

-
+    await refreshAppointmentsAndStats()
     closeCreateModal()
   } catch (e) {
     console.error(e)
     showToast(
         'Tạo lịch thất bại',
         e?.response?.data?.message || 'Có lỗi xảy ra, vui lòng thử lại.',
         'error'
     )
   }
 }

 // ===== Export (theo filter của table) =====
 function exportCSV() {
   const filtered = applyFilters(appointments.value)
   const header = ['Khách hàng', 'SĐT', 'Chi nhánh', 'Ngày', 'Giờ', 'NV phụ trách', 'Tình trạng', 'KQ tư vấn', 'Phân loại', 'Đánh giá', 'Người tạo', 'Ghi chú']

   const rows = filtered.map((a) => [
     a.customer,
     a.phone,
     a.branch ? BRANCHES.find((b) => b.key === a.branch)?.label || a.branch : '-',
     a.date,
     a.time,
     a.staff,
     STATUS[a.status].label,
     CONSULT_STATUS[a.consultStatus]?.label || '',
