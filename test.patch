diff --git a/src/components/dich-vu/Phi-dich-vu.vue b/src/components/dich-vu/Phi-dich-vu.vue
index 661c256627cd7b35dc0aec97bda904b7f11c6360..4b18137b22f02a3d9a5c151f5f216f335ea6dbfb 100644
--- a/src/components/dich-vu/Phi-dich-vu.vue
+++ b/src/components/dich-vu/Phi-dich-vu.vue
@@ -46,65 +46,69 @@
             </div>

             <div class="select filter-item filter-service" :class="{ active: filterService }">
               <label>Dịch vụ</label>
               <select v-model="filterService">
                 <option :value="null">Tất cả</option>
                 <option v-for="service in serviceOptions" :key="service.id || service.name" :value="service.id || service.name">{{ service.name }}</option>
               </select>
             </div>

             <div class="select filter-item filter-status" :class="{ active: filterStatus }">
               <label>Trạng thái</label>
               <select v-model="filterStatus">
                 <option :value="null">Tất cả</option>
                 <option value="DANG_HIEU_LUC">DANG_HIEU_LUC</option>
                 <option value="HOAN_TAT">HOAN_TAT</option>
                 <option value="HUY">HUY</option>
               </select>
             </div>
           </div>
         </div>

         <div class="panel-b">
           <!-- KPIs -->
           <div class="kpi-row">
-            <div class="kpi">
+            <div class="kpi kpi-total">
               <div class="k"><span class="dot"></span>Tổng hợp đồng</div>
               <div class="v price p4">{{ totalElements }}</div>
+              <div class="kpi-ico"><i class="fa-solid fa-file-signature"></i></div>
             </div>
-            <div class="kpi">
+            <div class="kpi kpi-revenue">
               <div class="k"><span class="dot"></span>Tổng doanh thu</div>
               <div class="v price p3">{{ formatMoney(totalDoanhThu) }}</div>
+              <div class="kpi-ico"><i class="fa-solid fa-chart-line"></i></div>
             </div>
-            <div class="kpi">
+            <div class="kpi kpi-adjust">
               <div class="k"><span class="dot"></span>Tổng điều chỉnh</div>
               <div class="v price p2">{{ formatMoney(totalDieuChinh) }}</div>
+              <div class="kpi-ico"><i class="fa-solid fa-sliders"></i></div>
             </div>
-            <div class="kpi">
+            <div class="kpi kpi-sales">
               <div class="k"><span class="dot"></span>Tổng doanh số</div>
               <div class="v price p1">{{ formatMoney(totalDoanhSo) }}</div>
+              <div class="kpi-ico"><i class="fa-solid fa-sack-dollar"></i></div>
             </div>
           </div>

           <div class="table-wrap">
             <div class="table-scroll">
               <table>
                 <thead>
                 <tr>
                   <th style="width:150px">Mã HĐ</th>
                   <th>Khách hàng</th>
                   <th style="width:260px">Dịch vụ</th>
                   <th style="width:160px">Giá tài sản</th>
                   <th style="width:140px">Giá sau giảm</th>
                   <th style="width:140px">Doanh thu</th>
                   <th style="width:140px">Doanh số</th>
                   <th style="width:120px">Trạng thái</th>
                   <th style="width:160px">Nhân viên tạo</th>
                   <th style="width:160px">Ngày tạo</th>
                   <th style="width:230px">Thao tác</th>
                 </tr>
                 </thead>
                 <tbody>
                 <tr v-if="contracts.length === 0">
                   <td colspan="11">
                     <div class="text-center py-10">
@@ -456,107 +460,107 @@
                     <select v-model="newContract.firstMethod">
                       <option value="CHUYEN_KHOAN">Chuyển khoản</option>
                       <option value="TIEN_MAT">Tiền mặt</option>
                     </select>
                     <div class="muted tiny">&nbsp;</div>
                   </div>
                 </div>
               </div>
             </div>
           </div>
         </div>

         <div class="modal-f">
           <button class="btn ghost" @click="closeModal('modalContract')">
             <i class="fa-solid fa-ban"></i> Hủy
           </button>
           <button class="btn primary" @click="saveContract">
             <i class="fa-solid fa-floppy-disk"></i> Lưu hợp đồng
           </button>
         </div>
       </div>
     </div>

     <!-- MODAL: PAY -->
     <div class="modal" :class="{ show: showModal === 'modalPay' }" @click.self="closeModal('modalPay')">
-      <div class="modal-card">
+      <div class="modal-card pay-modal">
         <div class="modal-h">
           <div class="modal-title">
             <i class="fa-solid fa-circle-dollar-to-slot"></i>
             Đóng phí
           </div>
           <button class="x" @click="closeModal('modalPay')">
             <i class="fa-solid fa-xmark"></i>
           </button>
         </div>
         <div class="modal-b">
           <div class="grid grid-cols-1 lg:grid-cols-2 gap-3">
             <div class="card">
               <div class="card-h"><i class="fa-solid fa-receipt"></i> Thông tin đợt đóng</div>
               <div class="field">
                 <label><i class="fa-solid fa-money-bill"></i> Số tiền đóng</label>
                 <input v-model.number="payment.amount" type="number" placeholder="VD: 3000000">
               </div>
               <div class="field">
                 <label><i class="fa-solid fa-credit-card"></i> Hình thức thanh toán</label>
                 <select v-model="payment.method">
                   <option value="TIEN_MAT">Tiền mặt</option>
                   <option value="CHUYEN_KHOAN">Chuyển khoản</option>
                 </select>
               </div>
               <div class="field">
                 <label><i class="fa-solid fa-calendar-day"></i> Ngày đóng tiền</label>
                 <input v-model="payment.date" type="date">
               </div>
               <div class="field">
                 <label><i class="fa-solid fa-note-sticky"></i> Ghi chú</label>
                 <input v-model="payment.note" type="text" placeholder="VD: Đợt 2">
               </div>
             </div>

             <div class="card">
               <div class="card-h"><i class="fa-solid fa-circle-info"></i> Tóm tắt hợp đồng</div>
               <div class="p-3">
                 <div class="text-sm font-extrabold">{{ currentContract?.maHopDong }} • {{ currentContract?.tenKhachHang }}</div>
                 <div class="muted tiny mt-1">{{ currentContract?.tenDichVu }} • Ngày tạo {{ formatCreatedAt(currentContract?.ngayTao) }} • Trạng thái {{ getStatusText(currentContract?.trangThaiHopDong) }}</div>

                 <div class="grid grid-cols-2 gap-2 mt-3">
                   <div class="kpi">
-                    <div class="k"><span class="dot"></span>Giá điều chỉnh</div>
-                    <div class="v price p2">{{ formatMoney(calcGiaDieuChinh(currentContract)) }}</div>
+                    <div class="k"><span class="dot"></span>Giá sau giảm</div>
+                    <div class="v price p4">{{ formatMoney(currentContract?.giaSauGiam || 0) }}</div>
                   </div>
                   <div class="kpi">
-                    <div class="k"><span class="dot"></span>Thực thu</div>
-                    <div class="v price p3">{{ formatMoney(calcThucThu(currentContract)) }}</div>
+                    <div class="k"><span class="dot"></span>Tổng điều chỉnh</div>
+                    <div class="v price p2">{{ formatMoney(calcTongDieuChinh(currentContract)) }}</div>
                   </div>
                   <div class="kpi">
-                    <div class="k"><span class="dot"></span>Doanh thu (min)</div>
-                    <div class="v price p1">{{ formatMoney(calcDoanhThu(currentContract)) }}</div>
+                    <div class="k"><span class="dot"></span>Còn thiếu</div>
+                    <div class="v price p1">{{ formatMoney(Math.max(0, calcGiaDieuChinh(currentContract) - calcThucThu(currentContract))) }}</div>
                   </div>
                   <div class="kpi">
-                    <div class="k"><span class="dot"></span>Còn thiếu</div>
-                    <div class="v price p4">{{ formatMoney(Math.max(0, calcGiaDieuChinh(currentContract) - calcThucThu(currentContract))) }}</div>
+                    <div class="k"><span class="dot"></span>Đã thu</div>
+                    <div class="v price p3">{{ formatMoney(calcThucThu(currentContract)) }}</div>
                   </div>
                 </div>

                 <div class="note mt-3">
                   <b>Lưu ý:</b> Đóng phí sẽ làm tăng <span class="mono">Thực thu</span>.
                 </div>
               </div>
             </div>
           </div>
         </div>

         <div class="modal-f">
           <button class="btn ghost" @click="closeModal('modalPay')">
             <i class="fa-solid fa-ban"></i> Hủy
           </button>
           <button class="btn primary" @click="savePayment">
             <i class="fa-solid fa-check"></i> Xác nhận đóng
           </button>
         </div>
       </div>
     </div>

     <!-- MODAL: REFUND -->
     <div class="modal" :class="{ show: showModal === 'modalRefund' }" @click.self="closeModal('modalRefund')">
       <div class="modal-card">
@@ -1622,71 +1626,85 @@ export default {
         }

         await this.fetchContracts()
         updateAlertSuccess('Đã tạo hợp đồng',
             `${contract.maHopDong} • ${this.newContract.initPlan === 'FULL' ? 'Đóng tất' : 'Cọc'}: ${this.formatMoney(this.firstPaymentAmount)}`)
         this.closeModal('modalContract')

       } catch (error) {
         console.error('❌ Lỗi tạo hợp đồng', error)
         updateAlertError('Tạo hợp đồng thất bại', 'Vui lòng thử lại sau.')
       }
     },

     // Payment management
     openPay(contract) {
       this.currentContract = contract
       this.payment = {
         amount: 0,
         method: 'CHUYEN_KHOAN',
         date: this.todayISO(),
         note: ''
       }
       this.openModal('modalPay')
     },

-    savePayment() {
+    async savePayment() {
       if (this.payment.amount <= 0) {
         this.showToastMessage('error', 'Số tiền không hợp lệ', 'Số tiền đóng phải > 0.')
         return
       }

       const contractIndex = this.contracts.findIndex(c => c.id === this.currentContract.id)
       if (contractIndex === -1) return

-      this.contracts[contractIndex].dotDongTien.push({
-        id: crypto.randomUUID(),
+      const payload = {
+        hopDongId: this.currentContract.id,
         soTienDong: this.payment.amount,
         hinhThucThanhToan: this.payment.method,
         ngayDongTien: this.payment.date || this.todayISO(),
-        ghiChu: this.payment.note,
-        nguoiGhiNhan: 'demo_admin',
-        ngayTao: new Date().toLocaleString('vi-VN')
-      })
+        ghiChu: this.payment.note
+      }

-      this.showToastMessage('success', 'Đóng phí thành công', `+${this.formatMoney(this.payment.amount)} (${this.payment.method})`)
-      this.closeModal('modalPay')
+      try {
+        await showLoading(api.post('/hop-dong/admin/dong-phi', payload))
+        this.contracts[contractIndex].dotDongTien.push({
+          id: crypto.randomUUID(),
+          soTienDong: this.payment.amount,
+          hinhThucThanhToan: this.payment.method,
+          ngayDongTien: payload.ngayDongTien,
+          ghiChu: this.payment.note,
+          nguoiGhiNhan: 'demo_admin',
+          ngayTao: new Date().toLocaleString('vi-VN')
+        })
+        updateAlertSuccess('Đóng phí thành công', `+${this.formatMoney(this.payment.amount)} (${this.payment.method})`)
+        await this.fetchContracts()
+        this.closeModal('modalPay')
+      } catch (error) {
+        console.error('❌ Lỗi đóng phí', error)
+        updateAlertError('Đóng phí thất bại', 'Vui lòng thử lại sau.')
+      }
     },

     // Refund management
     openRefund(contract) {
       this.currentContract = contract
       this.refund = {
         amount: 0,
         date: this.todayISO(),
         reason: ''
       }
       this.openModal('modalRefund')
     },

     saveRefund() {
       if (this.refund.amount <= 0) {
         this.showToastMessage('error', 'Số tiền không hợp lệ', 'Số tiền hoàn phải > 0.')
         return
       }

       if (!this.refund.reason) {
         this.showToastMessage('error', 'Thiếu lý do', 'Bạn cần nhập lý do hoàn.')
         return
       }

       const contractIndex = this.contracts.findIndex(c => c.id === this.currentContract.id)
@@ -2357,50 +2375,80 @@ export default {
 .select select:focus{
   border-color: rgba(102,126,234,.55);
   box-shadow: 0 0 0 4px rgba(102,126,234,.14);
 }
 .tools-actions{ display:flex; justify-content:flex-end; gap:8px; flex-wrap:wrap; }

 /* =========================
    KPI
 ========================= */
 .kpi-row{
   display:grid;
   grid-template-columns: repeat(4, minmax(0,1fr));
   gap:10px;
   margin-bottom: 12px;
 }
 @media (max-width: 980px){ .kpi-row{ grid-template-columns: repeat(2, minmax(0,1fr)); } }
 @media (max-width: 520px){ .kpi-row{ grid-template-columns: 1fr; } }
 .kpi{
   border: 1px solid rgba(20,30,48,.12);
   border-radius: 14px;
   padding: 10px 12px;
   background: rgba(255,255,255,.84);
   box-shadow: 0 12px 24px rgba(20,30,48,.08);
   overflow:hidden;
 }
+.kpi-row .kpi{
+  position: relative;
+  border: none;
+  color: #fff;
+  background: var(--primary-gradient);
+}
+.kpi-row .kpi-total{ background: var(--primary-gradient); }
+.kpi-row .kpi-revenue{ background: var(--success-gradient); }
+.kpi-row .kpi-adjust{ background: var(--warning-gradient); }
+.kpi-row .kpi-sales{ background: var(--secondary-gradient); }
+.kpi-row .kpi .k{
+  color: rgba(255,255,255,.86);
+}
+.kpi-row .kpi .k .dot{
+  background: rgba(255,255,255,.75);
+}
+.kpi-row .kpi .v{
+  color: #fff;
+}
+.kpi-row .kpi .v.price{
+  background: none;
+  -webkit-text-fill-color: #fff;
+}
+.kpi-row .kpi-ico{
+  position: absolute;
+  top: 10px;
+  right: 10px;
+  font-size: 24px;
+  opacity: 0.4;
+}
 .kpi .k{
   font-size: 11px;
   color: rgba(11,18,32,.60);
   font-weight: 900;
   letter-spacing: .3px;
   text-transform: uppercase;
   display:flex;
   gap:8px;
   align-items:center;
 }
 .kpi .k .dot{
   width: 8px; height: 8px; border-radius: 999px;
   background: var(--info-gradient);
   flex: 0 0 auto;
 }
 .kpi .v{
   margin-top: 4px;
   font-weight: 950;
   font-size: 16px;
   white-space: nowrap;
   overflow:hidden;
   text-overflow: ellipsis;
 }
 .price{ font-weight: 950; white-space: nowrap; }
 .p1{ background: var(--primary-gradient); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
@@ -2582,50 +2630,53 @@ tbody tr:hover{ background: rgba(79,172,254,.08); }
 ========================= */
 .modal{
   position: fixed;
   inset: 0;
   background: rgba(0,0,0,.55);
   backdrop-filter: blur(7px);
   z-index: 80;
   display:none;
   align-items:center;
   justify-content:center;
   padding: 16px;
 }
 .modal.show{ display:flex; }
 .modal-card{
   width: min(980px, 100%);
   max-height: calc(100vh - 32px);
   overflow: hidden;
   background: rgba(255,255,255,.96);
   border: 1px solid rgba(255,255,255,.35);
   border-radius: 18px;
   box-shadow: 0 34px 80px rgba(0,0,0,.32);
   animation: pop .16s ease;
   display:flex;
   flex-direction: column;
 }
+.modal-card.pay-modal{
+  width: min(1120px, 100%);
+}
 .modal-card.detail{
   background:
       radial-gradient(120% 120% at 0% 0%, rgba(255,214,214,.55), transparent 55%),
       radial-gradient(120% 120% at 100% 0%, rgba(206,221,255,.55), transparent 60%),
       radial-gradient(120% 120% at 100% 100%, rgba(210,255,238,.55), transparent 55%),
       linear-gradient(160deg, rgba(255,255,255,.98), rgba(255,255,255,.92));
   border: 1px solid rgba(168,185,255,.35);
   box-shadow: 0 35px 90px rgba(88,116,255,.22);
 }
 @keyframes pop{ from{ opacity:0; transform: translateY(10px) scale(.98);} to{ opacity:1; transform: translateY(0) scale(1);} }

 .modal-h{
   padding: 12px 12px;
   display:flex;
   align-items:center;
   justify-content:space-between;
   gap:10px;
   border-bottom: 1px solid rgba(20,30,48,.10);
   background: linear-gradient(90deg, rgba(255,224,235,.60), rgba(224,238,255,.60), rgba(226,255,244,.60));
 }
 .modal-title{
   display:flex;
   align-items:center;
   gap:10px;
   font-weight: 950;
