<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản Lý Dịch Vụ - Service Management</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Custom CSS cho giao diện chuyên nghiệp */
        :root {
            --primary-color: #3b82f6;
            --primary-dark: #2563eb;
            --secondary-color: #10b981;
            --danger-color: #ef4444;
            --warning-color: #f59e0b;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        .sidebar-item.active {
            background-color: rgba(59, 130, 246, 0.1);
            border-right: 4px solid var(--primary-color);
            color: var(--primary-color);
            font-weight: 600;
        }

        .service-card {
            transition: all 0.2s ease;
            border-radius: 0.75rem;
            overflow: hidden;
        }

        .service-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .price-item {
            border-bottom: 1px solid #e5e7eb;
            transition: background-color 0.2s ease;
        }

        .price-item:hover {
            background-color: #f9fafb;
        }

        .color-badge {
            display: inline-block;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            margin-right: 8px;
            vertical-align: middle;
        }

        /* Custom scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #a1a1a1;
        }

        /* Animation cho các phần tử */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                position: static;
            }

            .main-content {
                margin-left: 0;
            }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
<div class="flex min-h-screen">
    <!-- Sidebar -->
    <div class="sidebar w-64 bg-white shadow-lg fixed h-full overflow-y-auto custom-scrollbar">
        <div class="p-6 border-b">
            <h1 class="text-2xl font-bold text-gray-800">
                <i class="fas fa-cogs text-blue-500 mr-2"></i>
                Service Manager
            </h1>
            <p class="text-gray-500 text-sm mt-1">Quản lý dịch vụ chuyên nghiệp</p>
        </div>

        <nav class="mt-6">
            <a href="#" class="sidebar-item active flex items-center p-4 text-gray-700 hover:bg-blue-50">
                <i class="fas fa-list-alt mr-3 text-blue-500"></i>
                <span>Danh sách dịch vụ</span>
            </a>
            <a href="#" class="flex items-center p-4 text-gray-700 hover:bg-blue-50">
                <i class="fas fa-chart-line mr-3 text-green-500"></i>
                <span>Báo cáo & Thống kê</span>
            </a>
            <a href="#" class="flex items-center p-4 text-gray-700 hover:bg-blue-50">
                <i class="fas fa-cog mr-3 text-gray-500"></i>
                <span>Cài đặt hệ thống</span>
            </a>
            <a href="#" class="flex items-center p-4 text-gray-700 hover:bg-blue-50">
                <i class="fas fa-question-circle mr-3 text-purple-500"></i>
                <span>Trợ giúp & Hỗ trợ</span>
            </a>
        </nav>

        <div class="absolute bottom-0 w-full p-4 border-t bg-gray-50">
            <div class="flex items-center">
                <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center">
                    <i class="fas fa-user text-blue-600"></i>
                </div>
                <div class="ml-3">
                    <p class="font-medium">Nguyễn Văn A</p>
                    <p class="text-xs text-gray-500">Quản trị viên</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content ml-64 flex-1 p-8 fade-in">
        <!-- Header -->
        <div class="flex justify-between items-center mb-8">
            <div>
                <h2 class="text-3xl font-bold text-gray-800">Quản lý dịch vụ</h2>
                <p class="text-gray-600">Quản lý và cấu hình các dịch vụ của hệ thống</p>
            </div>
            <div class="flex space-x-3">
                <button class="px-5 py-2.5 bg-blue-50 text-blue-600 rounded-lg font-medium hover:bg-blue-100 transition-colors">
                    <i class="fas fa-filter mr-2"></i>Lọc dịch vụ
                </button>
                <button id="addServiceBtn" class="px-5 py-2.5 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors">
                    <i class="fas fa-plus mr-2"></i>Thêm dịch vụ
                </button>
            </div>
        </div>

        <!-- Thông báo -->
        <div class="mb-6 p-4 bg-green-50 text-green-700 rounded-lg border border-green-200 flex justify-between items-center">
            <div class="flex items-center">
                <i class="fas fa-check-circle mr-3"></i>
                <span>Đã tải thành công <strong id="serviceCount">2</strong> dịch vụ từ hệ thống</span>
            </div>
            <button class="text-green-600 hover:text-green-800">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <!-- Service Cards Container -->
        <div id="servicesContainer" class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Service cards will be dynamically loaded here -->
        </div>

        <!-- Statistics Section -->
        <div class="mt-12">
            <h3 class="text-xl font-bold mb-6 text-gray-800">Tổng quan dịch vụ</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-white p-6 rounded-xl shadow border">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-gray-500 text-sm">Tổng số dịch vụ</p>
                            <p class="text-3xl font-bold mt-2">2</p>
                        </div>
                        <div class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center">
                            <i class="fas fa-cogs text-blue-600 text-xl"></i>
                        </div>
                    </div>
                    <div class="mt-4 pt-4 border-t">
                        <p class="text-green-600 text-sm">
                            <i class="fas fa-arrow-up mr-1"></i> 0% so với tháng trước
                        </p>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow border">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-gray-500 text-sm">Tổng số phân khúc giá</p>
                            <p class="text-3xl font-bold mt-2">6</p>
                        </div>
                        <div class="w-12 h-12 rounded-full bg-green-100 flex items-center justify-center">
                            <i class="fas fa-tags text-green-600 text-xl"></i>
                        </div>
                    </div>
                    <div class="mt-4 pt-4 border-t">
                        <p class="text-green-600 text-sm">
                            <i class="fas fa-arrow-up mr-1"></i> Trung bình 3 phân khúc/dịch vụ
                        </p>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow border">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-gray-500 text-sm">Dịch vụ đang hoạt động</p>
                            <p class="text-3xl font-bold mt-2">2</p>
                        </div>
                        <div class="w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center">
                            <i class="fas fa-check-circle text-purple-600 text-xl"></i>
                        </div>
                    </div>
                    <div class="mt-4 pt-4 border-t">
                        <p class="text-green-600 text-sm">
                            <i class="fas fa-check mr-1"></i> Tất cả dịch vụ đang hoạt động
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="mt-12 pt-8 border-t text-center text-gray-500 text-sm">
            <p>© 2023 Service Management System. Phiên bản 2.1.0</p>
            <p class="mt-1">Được thiết kế với <i class="fas fa-heart text-red-500"></i> để mang lại trải nghiệm tốt nhất</p>
        </div>
    </div>
</div>

<!-- Modal thêm/sửa dịch vụ -->
<div id="serviceModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto custom-scrollbar">
        <div class="p-6 border-b">
            <h3 class="text-2xl font-bold text-gray-800" id="modalTitle">Thêm dịch vụ mới</h3>
            <p class="text-gray-600 mt-1">Nhập thông tin chi tiết của dịch vụ</p>
        </div>

        <form id="serviceForm" class="p-6">
            <div class="space-y-6">
                <div>
                    <label class="block text-gray-700 font-medium mb-2" for="serviceName">Tên dịch vụ *</label>
                    <input type="text" id="serviceName" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition" placeholder="Nhập tên dịch vụ" required>
                </div>

                <div>
                    <label class="block text-gray-700 font-medium mb-2" for="serviceDescription">Mô tả dịch vụ</label>
                    <textarea id="serviceDescription" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition" placeholder="Nhập mô tả chi tiết về dịch vụ"></textarea>
                </div>

                <div>
                    <label class="block text-gray-700 font-medium mb-2" for="serviceColor">Màu phân loại *</label>
                    <div class="flex space-x-4">
                        <div class="color-option flex items-center">
                            <input type="radio" id="color-blue" name="serviceColor" value="#3b82f6" class="hidden" checked>
                            <label for="color-blue" class="w-10 h-10 rounded-full bg-blue-500 cursor-pointer border-2 border-transparent hover:border-blue-700 color-sample"></label>
                            <span class="ml-2 text-gray-700">Xanh dương</span>
                        </div>
                        <div class="color-option flex items-center">
                            <input type="radio" id="color-green" name="serviceColor" value="#10b981" class="hidden">
                            <label for="color-green" class="w-10 h-10 rounded-full bg-green-500 cursor-pointer border-2 border-transparent hover:border-green-700 color-sample"></label>
                            <span class="ml-2 text-gray-700">Xanh lá</span>
                        </div>
                        <div class="color-option flex items-center">
                            <input type="radio" id="color-purple" name="serviceColor" value="#8b5cf6" class="hidden">
                            <label for="color-purple" class="w-10 h-10 rounded-full bg-purple-500 cursor-pointer border-2 border-transparent hover:border-purple-700 color-sample"></label>
                            <span class="ml-2 text-gray-700">Tím</span>
                        </div>
                        <div class="color-option flex items-center">
                            <input type="radio" id="color-orange" name="serviceColor" value="#f59e0b" class="hidden">
                            <label for="color-orange" class="w-10 h-10 rounded-full bg-orange-500 cursor-pointer border-2 border-transparent hover:border-orange-700 color-sample"></label>
                            <span class="ml-2 text-gray-700">Cam</span>
                        </div>
                    </div>
                </div>

                <div>
                    <div class="flex justify-between items-center mb-4">
                        <label class="block text-gray-700 font-medium">Danh sách giá theo phân khúc tài sản</label>
                        <button type="button" id="addPriceBtn" class="px-4 py-2 bg-blue-100 text-blue-600 rounded-lg font-medium hover:bg-blue-200 transition-colors text-sm">
                            <i class="fas fa-plus mr-1"></i> Thêm phân khúc giá
                        </button>
                    </div>

                    <div id="priceList" class="space-y-4">
                        <!-- Price items will be added here dynamically -->
                        <div class="price-item-input flex items-center space-x-4 p-4 bg-gray-50 rounded-lg">
                            <div class="flex-1">
                                <label class="block text-gray-600 text-sm mb-1">Giá trị tài sản tối thiểu (Min)</label>
                                <input type="number" class="price-min w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition" placeholder="0" min="0" required>
                            </div>
                            <div class="flex-1">
                                <label class="block text-gray-600 text-sm mb-1">Giá trị tài sản tối đa (Max)</label>
                                <input type="number" class="price-max w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition" placeholder="1000000" min="0" required>
                            </div>
                            <div class="flex-1">
                                <label class="block text-gray-600 text-sm mb-1">Giá dịch vụ</label>
                                <input type="number" class="price-value w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition" placeholder="500000" min="0" required>
                            </div>
                            <button type="button" class="remove-price-btn text-red-500 hover:text-red-700 mt-6">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="flex justify-end space-x-4 mt-8 pt-6 border-t">
                <button type="button" id="cancelModalBtn" class="px-6 py-3 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors">
                    Hủy bỏ
                </button>
                <button type="submit" class="px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors">
                    Lưu dịch vụ
                </button>
            </div>
        </form>
    </div>
</div>

<script>
    // Mock data cho dịch vụ
    const mockServices = [
        {
            id: 1,
            name: "Bán nhanh 30 ngày",
            description: "Dịch vụ hỗ trợ bán tài sản nhanh chóng trong vòng 30 ngày với chiến lược marketing tối ưu và đội ngũ chuyên nghiệp.",
            color: "#3b82f6",
            prices: [
                { min: 0, max: 500000000, value: 15000000 },
                { min: 500000001, max: 2000000000, value: 30000000 },
                { min: 2000000001, max: 5000000000, value: 70000000 }
            ],
            active: true,
            createdAt: "2023-05-15"
        },
        {
            id: 2,
            name: "Bán giải pháp theo giá mong muốn",
            description: "Dịch vụ tư vấn và thực hiện chiến lược bán tài sản đạt được mức giá mong muốn của khách hàng với tỷ lệ thành công cao.",
            color: "#10b981",
            prices: [
                { min: 0, max: 1000000000, value: 20000000 },
                { min: 1000000001, max: 5000000000, value: 50000000 },
                { min: 5000000001, max: 10000000000, value: 100000000 }
            ],
            active: true,
            createdAt: "2023-06-22"
        }
    ];

    // Biến lưu trữ tạm
    let services = [...mockServices];
    let editingServiceId = null;

    // DOM Elements
    const servicesContainer = document.getElementById('servicesContainer');
    const serviceModal = document.getElementById('serviceModal');
    const modalTitle = document.getElementById('modalTitle');
    const serviceForm = document.getElementById('serviceForm');
    const serviceNameInput = document.getElementById('serviceName');
    const serviceDescriptionInput = document.getElementById('serviceDescription');
    const priceList = document.getElementById('priceList');
    const addPriceBtn = document.getElementById('addPriceBtn');
    const addServiceBtn = document.getElementById('addServiceBtn');
    const cancelModalBtn = document.getElementById('cancelModalBtn');
    const serviceCount = document.getElementById('serviceCount');

    // Định dạng tiền tệ
    const formatCurrency = (amount) => {
        return new Intl.NumberFormat('vi-VN', {
            style: 'currency',
            currency: 'VND'
        }).format(amount);
    };

    // Hiển thị danh sách dịch vụ
    function renderServices() {
        servicesContainer.innerHTML = '';
        serviceCount.textContent = services.length;

        services.forEach(service => {
            const serviceCard = document.createElement('div');
            serviceCard.className = 'service-card bg-white rounded-xl shadow border overflow-hidden fade-in';
            serviceCard.innerHTML = `
                    <div class="p-6">
                        <div class="flex justify-between items-start">
                            <div>
                                <div class="flex items-center mb-2">
                                    <span class="color-badge" style="background-color: ${service.color}"></span>
                                    <h3 class="text-xl font-bold text-gray-800">${service.name}</h3>
                                    ${service.active ? '<span class="ml-3 px-3 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full">Đang hoạt động</span>' : '<span class="ml-3 px-3 py-1 bg-red-100 text-red-800 text-xs font-medium rounded-full">Ngừng hoạt động</span>'}
                                </div>
                                <p class="text-gray-600 mb-4">${service.description}</p>
                                <div class="text-sm text-gray-500">
                                    <i class="far fa-calendar-alt mr-1"></i> Tạo ngày: ${service.createdAt}
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button class="edit-service-btn px-4 py-2 bg-blue-50 text-blue-600 rounded-lg font-medium hover:bg-blue-100 transition-colors text-sm" data-id="${service.id}">
                                    <i class="fas fa-edit mr-1"></i> Sửa
                                </button>
                                <button class="delete-service-btn px-4 py-2 bg-red-50 text-red-600 rounded-lg font-medium hover:bg-red-100 transition-colors text-sm" data-id="${service.id}">
                                    <i class="fas fa-trash mr-1"></i> Xóa
                                </button>
                            </div>
                        </div>

                        <div class="mt-6 pt-6 border-t">
                            <h4 class="font-medium text-gray-700 mb-4">
                                <i class="fas fa-tags mr-2"></i>Bảng giá theo phân khúc tài sản
                            </h4>
                            <div class="overflow-x-auto">
                                <table class="w-full text-sm text-left text-gray-700">
                                    <thead class="text-xs text-gray-500 uppercase bg-gray-50">
                                        <tr>
                                            <th class="px-4 py-3">Phân khúc tài sản</th>
                                            <th class="px-4 py-3">Giá trị tài sản (Min - Max)</th>
                                            <th class="px-4 py-3">Giá dịch vụ</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${service.prices.map(price => `
                                            <tr class="price-item border-b hover:bg-gray-50">
                                                <td class="px-4 py-3">
                                                    <div class="font-medium">${formatCurrency(price.min)} - ${formatCurrency(price.max)}</div>
                                                </td>
                                                <td class="px-4 py-3">
                                                    Từ ${formatCurrency(price.min)} đến ${formatCurrency(price.max)}
                                                </td>
                                                <td class="px-4 py-3 font-bold text-blue-600">${formatCurrency(price.value)}</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                `;

            servicesContainer.appendChild(serviceCard);
        });

        // Thêm sự kiện cho các nút chỉnh sửa và xóa
        document.querySelectorAll('.edit-service-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const serviceId = parseInt(e.currentTarget.getAttribute('data-id'));
                openEditModal(serviceId);
            });
        });

        document.querySelectorAll('.delete-service-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const serviceId = parseInt(e.currentTarget.getAttribute('data-id'));
                deleteService(serviceId);
            });
        });
    }

    // Mở modal thêm dịch vụ mới
    function openAddModal() {
        editingServiceId = null;
        modalTitle.textContent = 'Thêm dịch vụ mới';
        serviceForm.reset();

        // Reset màu về mặc định
        document.getElementById('color-blue').checked = true;

        // Reset danh sách giá
        priceList.innerHTML = `
                <div class="price-item-input flex items-center space-x-4 p-4 bg-gray-50 rounded-lg">
                    <div class="flex-1">
                        <label class="block text-gray-600 text-sm mb-1">Giá trị tài sản tối thiểu (Min)</label>
                        <input type="number" class="price-min w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition" placeholder="0" min="0" required>
                    </div>
                    <div class="flex-1">
                        <label class="block text-gray-600 text-sm mb-1">Giá trị tài sản tối đa (Max)</label>
                        <input type="number" class="price-max w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition" placeholder="1000000" min="0" required>
                    </div>
                    <div class="flex-1">
                        <label class="block text-gray-600 text-sm mb-1">Giá dịch vụ</label>
                        <input type="number" class="price-value w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition" placeholder="500000" min="0" required>
                    </div>
                    <button type="button" class="remove-price-btn text-red-500 hover:text-red-700 mt-6">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;

        // Thêm sự kiện cho nút xóa giá
        document.querySelectorAll('.remove-price-btn').forEach(btn => {
            btn.addEventListener('click', removePriceItem);
        });

        serviceModal.classList.remove('hidden');
    }

    // Mở modal chỉnh sửa dịch vụ
    function openEditModal(serviceId) {
        const service = services.find(s => s.id === serviceId);
        if (!service) return;

        editingServiceId = serviceId;
        modalTitle.textContent = 'Chỉnh sửa dịch vụ';

        // Điền thông tin dịch vụ vào form
        serviceNameInput.value = service.name;
        serviceDescriptionInput.value = service.description;

        // Chọn màu phù hợp
        const colorInput = document.querySelector(`input[value="${service.color}"]`);
        if (colorInput) {
            colorInput.checked = true;
        }

        // Hiển thị danh sách giá
        priceList.innerHTML = '';
        service.prices.forEach(price => {
            addPriceItem(price.min, price.max, price.value);
        });

        serviceModal.classList.remove('hidden');
    }

    // Đóng modal
    function closeModal() {
        serviceModal.classList.add('hidden');
        editingServiceId = null;
    }

    // Thêm một dòng giá mới
    function addPriceItem(min = '', max = '', value = '') {
        const priceItem = document.createElement('div');
        priceItem.className = 'price-item-input flex items-center space-x-4 p-4 bg-gray-50 rounded-lg';
        priceItem.innerHTML = `
                <div class="flex-1">
                    <label class="block text-gray-600 text-sm mb-1">Giá trị tài sản tối thiểu (Min)</label>
                    <input type="number" class="price-min w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition" placeholder="0" min="0" value="${min}" required>
                </div>
                <div class="flex-1">
                    <label class="block text-gray-600 text-sm mb-1">Giá trị tài sản tối đa (Max)</label>
                    <input type="number" class="price-max w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition" placeholder="1000000" min="0" value="${max}" required>
                </div>
                <div class="flex-1">
                    <label class="block text-gray-600 text-sm mb-1">Giá dịch vụ</label>
                    <input type="number" class="price-value w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition" placeholder="500000" min="0" value="${value}" required>
                </div>
                <button type="button" class="remove-price-btn text-red-500 hover:text-red-700 mt-6">
                    <i class="fas fa-trash"></i>
                </button>
            `;

        priceList.appendChild(priceItem);

        // Thêm sự kiện cho nút xóa
        priceItem.querySelector('.remove-price-btn').addEventListener('click', removePriceItem);
    }

    // Xóa một dòng giá
    function removePriceItem(e) {
        // Chỉ cho phép xóa nếu còn nhiều hơn 1 dòng
        if (priceList.children.length > 1) {
            e.currentTarget.closest('.price-item-input').remove();
        }
    }

    // Xử lý submit form
    function handleSubmitForm(e) {
        e.preventDefault();

        // Lấy giá trị từ form
        const name = serviceNameInput.value.trim();
        const description = serviceDescriptionInput.value.trim();
        const color = document.querySelector('input[name="serviceColor"]:checked').value;

        // Lấy danh sách giá
        const prices = [];
        const priceItems = priceList.querySelectorAll('.price-item-input');

        for (let item of priceItems) {
            const min = parseInt(item.querySelector('.price-min').value) || 0;
            const max = parseInt(item.querySelector('.price-max').value) || 0;
            const value = parseInt(item.querySelector('.price-value').value) || 0;

            if (min >= 0 && max >= min && value >= 0) {
                prices.push({ min, max, value });
            }
        }

        if (prices.length === 0) {
            alert('Vui lòng thêm ít nhất một phân khúc giá hợp lệ!');
            return;
        }

        if (editingServiceId) {
            // Cập nhật dịch vụ
            const serviceIndex = services.findIndex(s => s.id === editingServiceId);
            if (serviceIndex !== -1) {
                services[serviceIndex] = {
                    ...services[serviceIndex],
                    name,
                    description,
                    color,
                    prices
                };
            }
        } else {
            // Thêm dịch vụ mới
            const newId = services.length > 0 ? Math.max(...services.map(s => s.id)) + 1 : 1;
            const newService = {
                id: newId,
                name,
                description,
                color,
                prices,
                active: true,
                createdAt: new Date().toISOString().split('T')[0]
            };

            services.push(newService);
        }

        // Render lại danh sách và đóng modal
        renderServices();
        closeModal();

        // Hiển thị thông báo thành công
        showNotification(`${editingServiceId ? 'Cập nhật' : 'Thêm'} dịch vụ "${name}" thành công!`, 'success');
    }

    // Xóa dịch vụ
    function deleteService(serviceId) {
        if (confirm('Bạn có chắc chắn muốn xóa dịch vụ này không?')) {
            const serviceName = services.find(s => s.id === serviceId)?.name || '';
            services = services.filter(s => s.id !== serviceId);
            renderServices();
            showNotification(`Đã xóa dịch vụ "${serviceName}" thành công!`, 'info');
        }
    }

    // Hiển thị thông báo
    function showNotification(message, type = 'info') {
        // Tạo thông báo tạm thời
        const notification = document.createElement('div');
        notification.className = `fixed top-6 right-6 p-4 rounded-lg shadow-lg text-white z-50 fade-in ${type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500'}`;
        notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'} mr-3"></i>
                    <span>${message}</span>
                </div>
            `;

        document.body.appendChild(notification);

        // Tự động xóa sau 3 giây
        setTimeout(() => {
            notification.remove();
        }, 3000);
    }

    // Khởi tạo sự kiện
    function initEventListeners() {
        // Nút thêm dịch vụ
        addServiceBtn.addEventListener('click', openAddModal);

        // Nút thêm phân khúc giá
        addPriceBtn.addEventListener('click', () => addPriceItem());

        // Nút hủy modal
        cancelModalBtn.addEventListener('click', closeModal);

        // Xử lý submit form
        serviceForm.addEventListener('submit', handleSubmitForm);

        // Đóng modal khi click ra ngoài
        serviceModal.addEventListener('click', (e) => {
            if (e.target === serviceModal) {
                closeModal();
            }
        });

        // Thêm hiệu ứng cho các mẫu màu
        document.querySelectorAll('.color-sample').forEach(sample => {
            sample.addEventListener('click', function() {
                // Xóa border của tất cả các mẫu màu
                document.querySelectorAll('.color-sample').forEach(s => {
                    s.classList.remove('border-blue-700', 'border-green-700', 'border-purple-700', 'border-orange-700');
                    s.classList.add('border-transparent');
                });

                // Thêm border cho mẫu màu được chọn
                const colorClass = this.style.backgroundColor.includes('blue') ? 'border-blue-700' :
                    this.style.backgroundColor.includes('green') ? 'border-green-700' :
                        this.style.backgroundColor.includes('purple') ? 'border-purple-700' : 'border-orange-700';

                this.classList.remove('border-transparent');
                this.classList.add(colorClass);
            });
        });
    }

    // Khởi tạo ứng dụng
    function initApp() {
        renderServices();
        initEventListeners();
    }

    // Chạy ứng dụng khi trang đã tải xong
    document.addEventListener('DOMContentLoaded', initApp);
</script>
</body>
</html>